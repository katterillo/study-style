{"version":3,"file":"dx-scheduler-core.umd.js","sources":["../src/utils.ts","../src/constants.ts","../src/plugins/common/helpers.ts","../src/plugins/common/computeds.ts","../src/plugins/appointments/helpers.ts","../src/plugins/week-view/helpers.ts","../src/plugins/week-view/computeds.ts","../src/plugins/vertical-rect/helpers.ts","../src/plugins/all-day-panel/helpers.ts","../src/plugins/appointment-form/constants.ts","../src/plugins/month-view/helpers.ts","../src/plugins/horizontal-rect/helpers.ts","../src/plugins/month-view/computeds.ts","../src/plugins/all-day-panel/computeds.ts","../src/plugins/integrated-grouping/helpers.ts","../src/plugins/integrated-grouping/computeds.ts","../src/plugins/common/calculate-rects.ts","../src/plugins/scheduler-core/helpers.ts","../src/plugins/scheduler-core/computeds.ts","../src/plugins/grouping-panel/utils.ts","../src/plugins/week-view/utils.ts","../src/plugins/view-state/reducers.ts","../src/plugins/appointment-tooltip/reducers.ts","../src/plugins/appointment-tooltip/constants.ts","../src/plugins/appointment-form/reducers.ts","../src/plugins/appointment-form/utils.ts","../src/plugins/appointment-form/helpers.ts","../src/plugins/editing-state/reducers.ts","../src/plugins/editing-state/computeds.ts","../src/plugins/editing-state/helpers.ts","../src/plugins/drag-drop-provider/helpers.ts","../src/plugins/current-time-indicator/helpers.tsx","../src/plugins/resources/helpers.ts","../src/plugins/resources/computeds.ts","../src/plugins/grouping-state/reducers.ts","../src/plugins/common/utils.ts","../src/plugins/date-navigator/helpers.ts","../src/types/appointment-form.types.ts"],"sourcesContent":["import moment from 'moment';\nimport { CustomFunction, PureComputed } from '@devexpress/dx-core';\nimport { RRule, RRuleSet } from 'rrule';\nimport {\n  ComputedHelperFn, ViewPredicateFn,\n  CalculateFirstDateOfWeekFn, AppointmentMoment,\n  Interval, Rect, AppointmentKey,\n} from './types';\n\nexport const computed: ComputedHelperFn = (getters, viewName, baseComputed, defaultValue) => {\n  if (getters.currentView.name !== viewName && !!defaultValue) {\n    return defaultValue;\n  }\n  return baseComputed(getters, viewName);\n};\n\nexport const toPercentage: PureComputed<\n  [number, number]\n> = (value, total) => (value * 100) / total;\n\nconst createExcludedInterval: CustomFunction<\n  [number, moment.Moment], Interval\n> = (day, start) => {\n  const leftBound = moment(start.day(day));\n  return [\n    leftBound,\n    moment(leftBound).hour(start.hour()).endOf('day'),\n  ];\n};\n\nexport const excludedIntervals: PureComputed<\n  [number[], moment.Moment], Interval[]\n> = (excludedDays, start) => excludedDays\n  .map(day => (day === 0 ? 7 : day))\n  .sort((a, b) => a - b)\n  .reduce((acc, day, i, allDays) => {\n    if (i && day === allDays[i - 1] + 1) {\n      acc[acc.length - 1][1].day(day);\n    } else {\n      acc.push(createExcludedInterval(day, start));\n    }\n    return acc;\n  }, [] as Interval[]);\n\nconst inInterval = (\n  date: moment.Moment, interval: Interval,\n) => date.isBetween(interval[0], interval[1], undefined, '[]');\n\nexport const viewPredicate: ViewPredicateFn = (\n  appointment, left, right,\n  excludedDays = [],\n  removeAllDayAppointments = false,\n) => {\n  const { start, end } = appointment;\n  const isAppointmentInBoundary = end.isAfter(left as Date)\n    && start.isBefore(right as Date);\n\n  const isAppointmentInExcludedDays = !!excludedIntervals(excludedDays, moment(left as Date))\n    .find(interval => (inInterval(start, interval) && inInterval(end, interval)));\n  const considerAllDayAppointment = removeAllDayAppointments\n    ? moment(end).diff(start, 'hours') < 24 && !appointment.allDay\n    : true;\n\n  return isAppointmentInBoundary && !isAppointmentInExcludedDays && considerAllDayAppointment;\n};\n\nexport const calculateFirstDateOfWeek: CalculateFirstDateOfWeekFn = (\n  currentDate, firstDayOfWeek, excludedDays = [],\n) => {\n  const currentLocale = moment.locale();\n  moment.updateLocale('tmp-locale', {\n    week: { dow: firstDayOfWeek, doy: 1 }, // `doy` is required for TS using\n  });\n  const firstDateOfWeek = moment(currentDate as Date).startOf('week');\n  if (excludedDays.indexOf(firstDayOfWeek) !== -1) {\n    excludedDays.slice().sort().forEach((day) => {\n      if (day === firstDateOfWeek.day()) {\n        firstDateOfWeek.add(1, 'days');\n      }\n    });\n  }\n  moment.locale(currentLocale);\n\n  return firstDateOfWeek.toDate();\n};\n\nexport const getAppointmentStyle: PureComputed<\n  [Rect], React.CSSProperties\n> = ({\n  top, left,\n  width, height,\n}) => ({\n  height,\n  width: `${width}%`,\n  transform: `translateY(${top}px)`,\n  msTransform: `translateY(${top}px)`,\n  left: `${left}%`,\n  position: 'absolute',\n});\n\nconst expandRecurrenceAppointment = (\n  appointment: AppointmentMoment, leftBound: Date, rightBound: Date,\n) => {\n  const rightBoundUTC = moment(getUTCDate(rightBound)).toDate();\n  const leftBoundUTC = moment(getUTCDate(leftBound)).toDate();\n  const appointmentStartDate = moment(appointment.start).toDate();\n  const options = {\n    ...RRule.parseString(appointment.rRule),\n    dtstart: moment(getUTCDate(appointmentStartDate)).toDate(),\n  };\n  const correctedOptions = options.until\n    ? { ...options, until: moment(getUTCDate(options.until)).toDate() }\n    : options;\n\n  const rruleSet = getRRuleSetWithExDates(appointment.exDate);\n\n  rruleSet.rrule(new RRule(correctedOptions));\n\n  // According to https://github.com/jakubroztocil/rrule#important-use-utc-dates\n  // we have to format the dates we get from RRuleSet to get local dates\n  const datesInBoundaries = rruleSet.between(leftBoundUTC as Date, rightBoundUTC as Date, true)\n    .map(formatDateToString);\n  if (datesInBoundaries.length === 0) return [];\n\n  const appointmentDuration = moment(appointment.end)\n    .diff(appointment.start, 'minutes');\n\n  return datesInBoundaries.map((startDate, index) => ({\n    ...appointment,\n    dataItem: {\n      ...appointment.dataItem,\n      startDate: moment(startDate).toDate(),\n      endDate: moment(startDate).add(appointmentDuration, 'minutes').toDate(),\n      parentData: appointment.dataItem,\n    },\n    start: moment(startDate),\n    end: moment(startDate).add(appointmentDuration, 'minutes'),\n    key: `${appointment.key}_rec_${index}`,\n  }));\n};\n\nexport const filterByViewBoundaries: PureComputed<\n  [AppointmentMoment, Date, Date, number[], boolean], AppointmentMoment[]\n> = (appointment, leftBound, rightBound, excludedDays, removeAllDay) => {\n  let appointments = [appointment];\n  if (appointment.rRule) {\n    appointments = expandRecurrenceAppointment(\n      appointment as AppointmentMoment, leftBound as Date, rightBound as Date,\n    );\n  }\n  return appointments.filter(appt => viewPredicate(\n    appt, leftBound, rightBound, excludedDays, removeAllDay,\n  ));\n};\n\nexport const getUTCDate: PureComputed<[Date], number> = date =>\n  Date.UTC(\n    date.getFullYear(),\n    date.getMonth(),\n    date.getDate(),\n    date.getHours(),\n    date.getMinutes(),\n);\n\nexport const getRRuleSetWithExDates: PureComputed<\n  [string | undefined], RRuleSet\n> = (exDate) => {\n  const rruleSet = new RRuleSet();\n  if (exDate) {\n    exDate.split(',').map((date: string) => {\n      const currentExDate = moment(date).toDate();\n      rruleSet.exdate(moment(getUTCDate(currentExDate)).toDate());\n    });\n  }\n  return rruleSet;\n};\n\nexport const formatDateToString = (date: Date | string | number) => moment.utc(date).format('YYYY-MM-DDTHH:mm');\n\nexport const addDateToKey: PureComputed<\n  [AppointmentKey, moment.Moment], AppointmentKey\n> = (prevKey, momentDate) => `${prevKey}_${momentDate.toDate().toString()}`;\n","import { GroupOrientation } from './types';\n\nexport const VERTICAL_TYPE = 'vertical';\nexport const HORIZONTAL_TYPE = 'horizontal';\n\nexport const SCROLL_OFFSET = 50;\nexport const SCROLL_SPEED_PX = 15;\n\nexport const SECONDS = 'seconds';\nexport const MINUTES = 'minutes';\nexport const HOURS = 'hours';\n\nexport const RESIZE_TOP = 'resize-start';\nexport const RESIZE_BOTTOM = 'resize-end';\n\nexport const POSITION_START = 'start';\nexport const POSITION_END = 'end';\n\nexport const AUTO_HEIGHT = 'auto';\n\nexport const DAY_OPTIONS = { day: 'numeric' };\nexport const WEEK_DAY_OPTIONS = { weekday: 'short' };\nexport const SHORT_MONTH_OPTIONS = { month: 'short' };\nexport const HOUR_MINUTE_OPTIONS = { hour: 'numeric', minute: 'numeric' };\nexport const MONTH_YEAR_OPTIONS = { month: 'long', year: 'numeric' };\nexport const DAY_SHORT_MONTH_OPTIONS = { day: 'numeric', month: 'short' };\nexport const SHORT_MONTH_LONG_YEAR_OPTIONS = { month: 'short', year: 'numeric' };\nexport const SHORT_MONTH_SHORT_YEAR_OPTIONS = { month: 'short', year: '2-digit' };\nexport const DAY_LONG_MONTH_LONG_YEAR_OPTIONS = { day: 'numeric', month: 'long', year: 'numeric' };\nexport const DAY_SHORT_MONTH_LONG_YEAR_OPTIONS = {\n  day: 'numeric', month: 'short', year: 'numeric',\n};\nexport const DAY_SHORT_MONTH_SHORT_YEAR_OPTIONS = {\n  day: 'numeric', month: 'short', year: '2-digit',\n};\nexport const LONG_WEEK_DAY_OPTIONS = { weekday: 'long' };\nexport const LONG_MONTH_OPTIONS = { month: 'long' };\nexport const DAY_LONG_MONTH_OPTIONS = { day: 'numeric', month: 'long' };\nexport const EMPTY_OPTIONS = {};\n\nexport const RECURRENCE_EDIT_SCOPE = {\n  ALL: 'all',\n  CURRENT_AND_FOLLOWING: 'currentAndFollowing',\n  CURRENT: 'current',\n};\n\nexport const TOGGLE_APPOINTMENT_FORM_VISIBILITY = 'toggleAppointmentFormVisibility';\nexport const TOGGLE_APPOINTMENT_TOOLTIP_VISIBILITY = 'toggleAppointmentTooltipVisibility';\n\nexport const WEEKDAY_INTERVAL = 'weekdayInterval';\n\nexport const VERTICAL_VIEW_LEFT_OFFSET = 80;\nexport const HORIZONTAL_VIEW_LEFT_OFFSET = 0;\n\nexport const VERTICAL_GROUP_ORIENTATION = 'Vertical' as GroupOrientation;\nexport const HORIZONTAL_GROUP_ORIENTATION = 'Horizontal' as GroupOrientation;\n\nexport const VIEW_TYPES = {\n  MONTH: 'month',\n  WEEK: 'week',\n  DAY: 'day',\n  ALL_DAY_PANEL: 'allDayPanel',\n};\n","import moment from 'moment';\nimport { PureComputed } from '@devexpress/dx-core';\nimport {\n  VERTICAL_TYPE, HORIZONTAL_TYPE, DAY_OPTIONS, SHORT_MONTH_OPTIONS,\n  DAY_SHORT_MONTH_OPTIONS, SHORT_MONTH_LONG_YEAR_OPTIONS,\n  SHORT_MONTH_SHORT_YEAR_OPTIONS, MONTH_YEAR_OPTIONS,\n  DAY_LONG_MONTH_LONG_YEAR_OPTIONS, DAY_SHORT_MONTH_SHORT_YEAR_OPTIONS,\n  DAY_SHORT_MONTH_LONG_YEAR_OPTIONS, LONG_WEEK_DAY_OPTIONS, EMPTY_OPTIONS,\n  WEEKDAY_INTERVAL,\n} from '../../constants';\nimport {\n  ViewBoundTextFn, FormatterFn, ViewCell,\n  AppointmentMoment, Group, SchedulerDateTime, CellElementsMeta,\n} from '../../types';\n\nconst MONTH_TYPE = 'month';\n\nexport const getViewType: PureComputed<[string], string> = (currentViewType) => {\n  if (currentViewType === MONTH_TYPE) return HORIZONTAL_TYPE;\n  return VERTICAL_TYPE;\n};\n\nexport const isMidnight: PureComputed<\n  [Date], boolean\n> = (date) => {\n  const momentDate = moment(date as Date);\n  return momentDate.hours() === 0 && momentDate.minutes() === 0 && momentDate.seconds() === 0;\n};\n\nconst calculateTextByDays: PureComputed<\n  [Date, Date, FormatterFn, object], string\n> = (startViewDate, endViewDate, formatDate, additionalOptions) => {\n  const momentStartViewDate = moment(startViewDate as Date);\n  const momentEndViewDate = moment(endViewDate as Date);\n\n  if (momentStartViewDate.isSame(momentEndViewDate, 'day')) {\n    return formatDate(momentStartViewDate.toDate(), {\n      ...DAY_LONG_MONTH_LONG_YEAR_OPTIONS, ...additionalOptions,\n    });\n  }\n  if (momentStartViewDate.isSame(momentEndViewDate, 'year')) {\n    if (momentStartViewDate.isSame(momentEndViewDate, 'month')) {\n      return `${\n        formatDate(momentStartViewDate.toDate(), DAY_OPTIONS)\n      }-${\n        formatDate(momentEndViewDate.toDate(), DAY_OPTIONS)\n      } ${\n        formatDate(momentEndViewDate.toDate(), MONTH_YEAR_OPTIONS)\n      }`;\n    }\n    return `${\n      formatDate(momentStartViewDate.toDate(), DAY_SHORT_MONTH_OPTIONS)\n    } - ${\n      formatDate(momentEndViewDate.toDate(), DAY_SHORT_MONTH_LONG_YEAR_OPTIONS)\n    }`;\n  }\n  return `${\n    formatDate(momentStartViewDate.toDate(), DAY_SHORT_MONTH_SHORT_YEAR_OPTIONS)\n  } - ${\n    formatDate(momentEndViewDate.toDate(), DAY_SHORT_MONTH_SHORT_YEAR_OPTIONS)\n  }`;\n};\n\nconst calculateTextByMonths: PureComputed<\n  [Date, number, FormatterFn], string\n> = (currentDate, intervalCount, formatDate) => {\n  const momentCurrentDate = moment(currentDate as Date);\n\n  if (intervalCount === 1) {\n    return formatDate(momentCurrentDate.toDate(), MONTH_YEAR_OPTIONS);\n  }\n  const lastMonth = momentCurrentDate.clone().add(intervalCount - 1, 'month');\n  if (momentCurrentDate.isSame(lastMonth, 'year')) {\n    return `${\n      formatDate(momentCurrentDate.toDate(), SHORT_MONTH_OPTIONS)\n    }-${\n      formatDate(lastMonth.toDate(), SHORT_MONTH_LONG_YEAR_OPTIONS)\n    }`;\n  }\n  return `${\n    formatDate(momentCurrentDate.toDate(), SHORT_MONTH_SHORT_YEAR_OPTIONS)\n  } - ${\n    formatDate(lastMonth.toDate(), SHORT_MONTH_SHORT_YEAR_OPTIONS)\n  }`;\n};\n\nexport const viewBoundText: ViewBoundTextFn = (\n  startViewDate, endViewDate, type, currentDate, intervalCount, formatDate,\n) => (type !== 'month'\n  ? calculateTextByDays(\n    startViewDate, endViewDate, formatDate,\n    type === WEEKDAY_INTERVAL ? LONG_WEEK_DAY_OPTIONS : EMPTY_OPTIONS,\n  )\n  : calculateTextByMonths(currentDate, intervalCount, formatDate)\n);\n\nexport const checkCellGroupingInfo: PureComputed<\n  [ViewCell, AppointmentMoment], boolean\n> = (cell, appointment) => cell.groupingInfo\n  ? cell.groupingInfo.every((group: Group) => (\n    group.id === appointment[group.fieldName]\n  ))\n  : true;\n\nexport const isDateValid: PureComputed<\n  [Date], boolean\n> = date => moment(date as Date).isValid();\n\nexport const convertToMoment: PureComputed<\n  [SchedulerDateTime], moment.Moment\n> = date => moment(date as SchedulerDateTime);\n\nexport const areDatesSame: PureComputed<\n  [SchedulerDateTime, SchedulerDateTime], boolean\n> = (firstDate, secondDate) => moment(firstDate as SchedulerDateTime)\n  .isSame(secondDate as SchedulerDateTime, 'date');\n\nexport const getTimeTableHeight: PureComputed<\n  [CellElementsMeta], number | undefined\n> = timeTableElementsMeta => timeTableElementsMeta.parentRect?.().height;\n\nexport const containsDSTChange = (date: SchedulerDateTime) => {\n  const momentDate = moment(date);\n  momentDate.startOf('day');\n  const isStartDST = momentDate.isDST();\n\n  momentDate.endOf('day');\n  const isEndDst = momentDate.isDST();\n\n  return (isStartDST && !isEndDst) || (!isStartDST && isEndDst);\n};\n","import moment from 'moment';\nimport { PureComputed } from '@devexpress/dx-core';\nimport {\n  TimeScale, SchedulerDateTime, ViewCell,\n  DayScaleFn, TimeScaleFn, ViewCellsDataFn, AllDayCell,\n  SchedulerView,\n} from '../../types';\nimport { calculateFirstDateOfWeek } from '../../utils';\nimport {\n  isMidnight,\n  containsDSTChange,\n} from './helpers';\n\nconst subtractSecond: PureComputed<\n  [Date]\n> = date => moment(date as Date).subtract(1, 'second').toDate();\n\nexport const dayScale: DayScaleFn = (\n  currentDate,\n  firstDayOfWeek,\n  dayCount,\n  excluded = [],\n) => {\n  const result: Date[] = [];\n  const date = firstDayOfWeek !== undefined\n    ? moment(calculateFirstDateOfWeek(currentDate, firstDayOfWeek, excluded) as Date)\n    : moment(currentDate as Date);\n  for (let index = 0; index < dayCount; index += 1) {\n    if (excluded.findIndex(item => item === date.day()) === -1) {\n      result.push(date.toDate());\n    }\n    date.add(1, 'days');\n  }\n  return result;\n};\n\nexport const timeScale: TimeScaleFn = (\n  currentDate,\n  firstDayOfWeek,\n  startDayHour,\n  endDayHour,\n  cellDuration,\n  excludedDays,\n) => {\n  const result: TimeScale[] = [];\n  const startDateOfView = firstDayOfWeek !== undefined\n    ? calculateFirstDateOfWeek(currentDate, firstDayOfWeek, excludedDays)\n    : currentDate;\n\n  const isDSTChange = containsDSTChange(startDateOfView as Date);\n  const validDate = moment(startDateOfView as Date);\n  if (isDSTChange) {\n    validDate.subtract(1, 'day');\n  }\n\n  const left = moment(validDate)\n    .startOf('day')\n    .add(startDayHour, 'hour');\n  const right = moment(validDate)\n    .startOf('day')\n    .add(endDayHour, 'hour');\n\n  while (left.isBefore(right)) {\n    const startDate = left.toDate();\n    left.add(cellDuration, 'minutes');\n    result.push({ start: startDate, end: left.toDate() });\n  }\n\n  const timeScaleLastIndex = result.length - 1;\n  if (isMidnight(result[timeScaleLastIndex].end)) {\n    result[timeScaleLastIndex].end = subtractSecond(result[timeScaleLastIndex].end) as Date;\n  }\n  return result;\n};\n\nexport const availableViews: PureComputed<\n  [SchedulerView[], string, string], SchedulerView[]\n> = (views, viewName, viewDisplayName) => {\n  if (!views) return [{ name: viewName, displayName: viewDisplayName }];\n  if (views.findIndex(view => viewName === view.name) === -1) {\n    const nextViews = views.slice();\n    nextViews.push({ name: viewName, displayName: viewDisplayName });\n    return nextViews;\n  }\n  return views;\n};\n\nexport const viewCellsData: ViewCellsDataFn = (\n  currentDate, firstDayOfWeek,\n  dayCount, excludedDays,\n  startDayHour, endDayHour,\n  cellDuration, currTime,\n) => {\n  const days = dayScale(currentDate, firstDayOfWeek!, dayCount!, excludedDays);\n  const times = timeScale(\n    currentDate, firstDayOfWeek!, startDayHour, endDayHour, cellDuration, excludedDays,\n  );\n  const currentTime = moment(currTime as SchedulerDateTime);\n  return times.reduce((cellsAcc, time) => {\n    const start = moment(time.start);\n    const end = moment(time.end);\n    const rowCells = days.reduce((rowAcc, day) => {\n      const startDate = moment(day).hours(start.hours()).minutes(start.minutes()).toDate();\n      const endDate = moment(day).hours(end.hours()).minutes(end.minutes()).toDate();\n      const today = currentTime.isSame(startDate, 'day');\n      rowAcc.push({ startDate, endDate, today });\n      return rowAcc;\n    }, [] as ViewCell[]);\n    cellsAcc.push(rowCells);\n    return cellsAcc;\n  }, [] as ViewCell[][]);\n};\n\nexport const timeCellsData: PureComputed<\n  [ViewCell[][], number, number, number, number], ViewCell[][]\n> = (\n  cellsData, startDayHour, endDayHour, cellDuration, currentTime,\n) => {\n  const { startDate: firstViewDate } = cellsData[0][0];\n  if (!containsDSTChange(firstViewDate)) {\n    return cellsData;\n  }\n\n  const nextDay = moment(firstViewDate)\n    .add(1, 'day')\n    .toDate();\n  const validCellsData = viewCellsData(\n    nextDay, undefined, 1, [], startDayHour, endDayHour, cellDuration, currentTime,\n  );\n\n  return validCellsData;\n};\n\nexport const allDayCells: PureComputed<\n  [ViewCell[][]], AllDayCell[][]\n> = viewCells => [viewCells[0].map(cell => ({\n  startDate: moment(cell.startDate).startOf('day').toDate(),\n  endDate: moment(cell.startDate).add(1, 'day').startOf('day').toDate(),\n  groupingInfo: cell.groupingInfo,\n  endOfGroup: cell.endOfGroup,\n}))];\n\nexport const startViewDate: PureComputed<\n  [ViewCell[][]], Date\n> = viewCells => moment(viewCells[0][0].startDate).toDate();\n\nexport const endViewDate: PureComputed<\n  [ViewCell[][]], Date\n> = (viewCells) => {\n  const lastRowIndex = viewCells.length - 1;\n  const lastCellIndex = viewCells[lastRowIndex].length - 1;\n  return subtractSecond(viewCells[lastRowIndex][lastCellIndex].endDate!);\n};\n","import { PureComputed, CustomFunction } from '@devexpress/dx-core';\nimport {\n  ViewCell, CellElementsMeta, GroupOrientation, AppointmentMoment,\n  AppointmentUnwrappedGroup, ViewMetaData, ElementRect, AppointmentGroup,\n  AppointmentForestRoots, CalculatedTreeNode, TreeNodeWithOverlappingSubTreeRoots,\n  TreeNodeInBlock, AppointmentBlock, IncludedBlock, BlockWithChildren, CalculatedBlock,\n  GroupedIntoBlocksForest, AppointmentIndex,\n\n  VisitRootsFn, CalculateRectByDateAndGroupIntervalsFn, CreateAppointmentForestFn,\n  VisitChildFn, VisitAllChildrenFn, IsPossibleChildFn, FindMaxReduceValueFn,\n  CalculateAppointmentsMetaDataFn, CalulateRootsMetaDataFn, CalculateChildMetaDataFn,\n  CalculateChildrenMetaDataFn, CalculateAppointmentLeftAndWidthFn, PrepareToGroupIntoBlocksFn,\n  IsOverlappingSubTreeRootFn, FindChildrenMaxEndDateFn, GroupAppointmentsIntoBlocksFn,\n  CalculateBlockSizeBEndDateFn, FindBlockIndexByAppointmentFn, FindIncludedBlocksFn,\n  IsIncludedBlockFn, FindChildBlocksFn, IsChildBlockFn, AdjustByBlocksFn,\n  CalculateBlockDimensionsFn, AlignBlocksWithPreviousFn, AdjustAppointemntsByBlocksFn,\n  RedistributeBlocksFn, CalculateIncludedBlockMaxRightFn, CalculateBlocksTotalSizeFn,\n  CalculateSingleBlockTotalSizeFn, CalculateBlocksLeftLimitFn, CalculateSingleBlockLeftLimitFn,\n  UpdateBlocksProportionsFn, UpdateBlocksLeftFn, CreateAndAdjustAppointmentForestFn,\n} from '../../types';\nimport { HORIZONTAL_GROUP_ORIENTATION, HORIZONTAL_TYPE, VERTICAL_TYPE } from '../../constants';\nimport { toPercentage } from '../../utils';\nimport moment from 'moment';\n\nconst MAX_WIDTH = 1;\nconst INDIRECT_CHILD_LEFT_OFFSET = 0.05;\n\nexport const isAllDayElementsMetaActual: PureComputed<\n  [ViewCell[][], CellElementsMeta, GroupOrientation, number], boolean\n> = (viewCellsData, allDayElementsMeta, groupOrientation, groupCount) => {\n  const numberOfRows = groupOrientation === HORIZONTAL_GROUP_ORIENTATION ? 1 : groupCount;\n  return isElementsMetaActual(viewCellsData, allDayElementsMeta, numberOfRows);\n};\n\nexport const isTimeTableElementsMetaActual: PureComputed<\n  [ViewCell[][], CellElementsMeta], boolean\n> = (viewCellsData, timeTableElementsMeta) => isElementsMetaActual(\n  viewCellsData, timeTableElementsMeta, viewCellsData.length,\n);\n\nconst isElementsMetaActual: PureComputed<\n  [ViewCell[][], CellElementsMeta, number], boolean\n> = (viewCellsData, elementsMeta, numberOfRows) => {\n  if (!elementsMeta?.getCellRects) {\n    return false;\n  }\n\n  const tableSize = numberOfRows * viewCellsData[0].length;\n  return tableSize === elementsMeta.getCellRects.length;\n};\n\nconst appointmentHeightType = (appointment: AppointmentMoment, cellDuration: number) => {\n  const durationRatio = appointment.end.clone().diff(appointment.start, 'minutes') / cellDuration;\n  if (durationRatio === 1) return 'middle';\n  if (durationRatio > 1) return 'long';\n  return 'short';\n};\n\nconst horizontalRectCalculator: CustomFunction<\n  [AppointmentUnwrappedGroup, ViewMetaData, any], ElementRect\n> = (\n  appointment,\n  viewMetaData,\n  {\n    rectByDates: getRectByAppointment,\n    multiline,\n    rectByDatesMeta: {\n      cellElementsMeta,\n      viewCellsData,\n    },\n  },\n) => {\n  const {\n    top, left,\n    width, height, parentWidth,\n  } = getRectByAppointment(\n    appointment,\n    viewMetaData,\n    {\n      multiline,\n      cellElementsMeta,\n      viewCellsData,\n    },\n  );\n\n  return {\n    resources: appointment.resources,\n    top: top + ((height / appointment.reduceValue) * appointment.offset),\n    height: height / appointment.reduceValue,\n    left: toPercentage(left, parentWidth),\n    width: toPercentage(width, parentWidth),\n    dataItem: appointment.dataItem,\n    fromPrev: appointment.fromPrev,\n    toNext: appointment.toNext,\n    type: HORIZONTAL_TYPE,\n    key: appointment.key,\n  };\n};\n\nconst verticalRectCalculator: CustomFunction<\n  [AppointmentUnwrappedGroup, ViewMetaData, any], ElementRect\n> = (\n  appointment,\n  viewMetaData,\n  {\n    rectByDates: getRectByAppointment,\n    multiline,\n    rectByDatesMeta: {\n      viewCellsData,\n      cellDuration,\n      cellElementsMeta,\n      excludedDays,\n    },\n  },\n) => {\n  const {\n    top, left,\n    width, height, parentWidth,\n  } = getRectByAppointment(\n    appointment,\n    viewMetaData,\n    {\n      multiline,\n      viewCellsData,\n      cellDuration,\n      excludedDays,\n      cellElementsMeta,\n    },\n  );\n\n  const { offset, width: relativeWidth, left: relativeLeft  } = appointment;\n  const widthMultiplier = (relativeWidth! * 5 / 3 + relativeLeft!) <= 1 ? 5 / 3 : 1;\n  let validWidth = widthMultiplier === 5 / 3\n    ? widthMultiplier * relativeWidth! : relativeWidth! + 0.02;\n  if (validWidth + relativeLeft! > 1) {\n    validWidth = 1 - relativeLeft!;\n  }\n\n  return {\n    resources: appointment.resources,\n    top,\n    height,\n    left: toPercentage(left + relativeLeft! * width, parentWidth),\n    width: toPercentage(validWidth! * width, parentWidth),\n    dataItem: appointment.dataItem,\n    fromPrev: appointment.fromPrev,\n    toNext: appointment.toNext,\n    durationType: appointmentHeightType(appointment, cellDuration),\n    type: VERTICAL_TYPE,\n    offset,\n    key: appointment.key,\n  };\n};\n\nconst oldVerticalRectCalculator: CustomFunction<\n  [AppointmentUnwrappedGroup, ViewMetaData, any], ElementRect\n> = (\n  appointment,\n  viewMetaData,\n  {\n    rectByDates: getRectByAppointment,\n    multiline,\n    rectByDatesMeta: {\n      viewCellsData,\n      cellDuration,\n      cellElementsMeta,\n      excludedDays,\n      placeAppointmentsNextToEachOther,\n    },\n  },\n) => {\n  const {\n    top, left,\n    width, height, parentWidth,\n  } = getRectByAppointment(\n    appointment,\n    viewMetaData,\n    {\n      multiline,\n      viewCellsData,\n      cellDuration,\n      excludedDays,\n      cellElementsMeta,\n      placeAppointmentsNextToEachOther,\n    },\n  );\n\n  const widthInPx = width / appointment.reduceValue;\n\n  return {\n    resources: appointment.resources,\n    top,\n    height,\n    left: toPercentage(left + (widthInPx * appointment.offset), parentWidth),\n    width: toPercentage(widthInPx, parentWidth),\n    dataItem: appointment.dataItem,\n    fromPrev: appointment.fromPrev,\n    toNext: appointment.toNext,\n    durationType: appointmentHeightType(appointment, cellDuration),\n    type: VERTICAL_TYPE,\n    key: appointment.key,\n  };\n};\n\nconst compareByDay: PureComputed<\n  [AppointmentMoment, AppointmentMoment], number\n> = (first, second) => {\n  if (first.start.isBefore(second.start, 'day')) return -1;\n  if (first.start.isAfter(second.start, 'day')) return 1;\n  return 0;\n};\n\nconst compareByAllDay: PureComputed<\n  [AppointmentMoment, AppointmentMoment], number\n> = (first, second) => {\n  if (first.allDay && !second.allDay) return -1;\n  if (!first.allDay && second.allDay) return 1;\n  return 0;\n};\n\nconst compareByTime: PureComputed<\n  [AppointmentMoment, AppointmentMoment], number\n> = (first, second) => {\n  if (first.start.isBefore(second.start)) return -1;\n  if (first.start.isAfter(second.start)) return 1;\n  if (first.end.isBefore(second.end)) return 1;\n  if (first.end.isAfter(second.end)) return -1;\n  return 0;\n};\n\nexport const sortAppointments: PureComputed<\n  [AppointmentMoment[]], AppointmentMoment[]\n> = appointments => appointments\n  .slice().sort((a, b) => compareByDay(a, b) || compareByAllDay(a, b) || compareByTime(a, b));\n\nconst byDayPredicate: PureComputed<\n  [moment.Moment, moment.Moment], boolean\n> = (boundary, date) => (\n  boundary.isSameOrAfter(date, 'day')\n  && !boundary.isSame(boundary.clone().startOf('day'))\n);\n\nexport const findOverlappedAppointments: CustomFunction<\n  [AppointmentMoment[], boolean], any[]\n> = (sortedAppointments, byDay = false) => {\n  const appointments = sortedAppointments.slice();\n  const groups: AppointmentMoment[][] = [];\n  let totalIndex = 0;\n\n  while (totalIndex < appointments.length) {\n    groups.push([]);\n    const current = appointments[totalIndex];\n    const currentGroup = groups[groups.length - 1];\n    let next = appointments[totalIndex + 1];\n    let maxBoundary = current.end;\n\n    currentGroup.push(current);\n    totalIndex += 1;\n    while (next && (maxBoundary.isAfter(next.start)\n      || (byDay && byDayPredicate(maxBoundary, next.start)))) {\n      currentGroup.push(next);\n      if (maxBoundary.isBefore(next.end)) maxBoundary = next.end;\n      totalIndex += 1;\n      next = appointments[totalIndex];\n    }\n  }\n  return groups;\n};\n\nconst isMidnight: PureComputed<\n  [moment.Moment], boolean\n> = date => date.isSame(date.clone().startOf('day'));\n\nconst maxBoundaryPredicate: PureComputed<\n  [moment.Moment, Date], boolean\n> = (maxBoundary, startDate) => ((maxBoundary.isBefore(startDate as Date, 'day'))\n  || (isMidnight(maxBoundary) && maxBoundary.isSame(startDate as Date, 'day')));\n\nexport const calculateAppointmentOffsets: CustomFunction<\n  [any[], boolean], AppointmentGroup[]\n> = (groups, byDay = false) => groups.map((items) => {\n  let offset = 0;\n  let reduceValue = 1;\n  const appointments = items.map((appointment: any) => ({ ...appointment }));\n  const groupLength = appointments.length;\n  for (let startIndex = 0; startIndex < groupLength; startIndex += 1) {\n    const appointment = appointments[startIndex];\n    if (appointment.offset === undefined) {\n      let maxBoundary = appointment.end;\n      appointment.offset = offset;\n      for (let index = startIndex + 1; index < groupLength; index += 1) {\n        if (appointments[index].offset === undefined) {\n          if ((!byDay && maxBoundary.isSameOrBefore(appointments[index].start))\n            || (byDay && maxBoundaryPredicate(maxBoundary, appointments[index].start))) {\n            maxBoundary = appointments[index].end;\n            appointments[index].offset = offset;\n          }\n        }\n      }\n\n      offset += 1;\n      if (reduceValue < offset) reduceValue = offset;\n    }\n  }\n  return { items: appointments, reduceValue };\n});\n\nconst unwrapAppointmentForest: PureComputed<\n  [GroupedIntoBlocksForest[]], AppointmentUnwrappedGroup[]\n> = (appointmentForests) => {\n  const forestUnwrapped = appointmentForests.map(({ items, reduceValue }) => ({\n    reduceValue,\n    items: items.map(({ data }) => ({ ...data })),\n  }));\n  return unwrapGroups(forestUnwrapped);\n};\n\nexport const unwrapGroups: PureComputed<\n  [AppointmentGroup[]], AppointmentUnwrappedGroup[]\n> = groups => groups.reduce((acc, { items, reduceValue }) => {\n  acc.push(...items.map(({ start, end, dataItem, offset, resources, key, ...restProps }) => ({\n    start, end, dataItem, offset, reduceValue, resources,\n    fromPrev: moment(start).diff(dataItem.startDate, 'minutes') > 1,\n    toNext: moment(dataItem.endDate).diff(end, 'minutes') > 1,\n    key,\n    ...restProps,\n  })));\n  return acc;\n}, [] as AppointmentUnwrappedGroup[]);\n\nexport const intervalIncludes: PureComputed<\n  [moment.Moment, moment.Moment, moment.Moment], boolean\n> = (intervalStart, intervalEnd, date) => date\n  .isBetween(intervalStart, intervalEnd, undefined, '[)');\n\nexport const createAppointmentForest: CreateAppointmentForestFn = (\n  appointmentGroups, cellDuration,\n) => appointmentGroups.map((appointmentGroup) => {\n  const { items } = appointmentGroup;\n  let nextItems;\n  let roots;\n  if (items.length === 1) {\n    nextItems = [{\n      data: items[0], children: [], treeDepth: 0, isDirectChild: false, hasDirectChild: false,\n    }];\n    roots = [0];\n  } else {\n    const {\n      appointments, roots: appointmentTreeRoots,\n    } = visitRoots(items, cellDuration) as AppointmentForestRoots;\n    nextItems = appointments;\n    roots = appointmentTreeRoots;\n  }\n  return {\n    ...appointmentGroup,\n    items: nextItems,\n    roots,\n  };\n});\n\nconst visitRoots: VisitRootsFn = (appointmentItems, cellDuration) => {\n  const appointmentNodes: any[] = appointmentItems.map(props => ({\n    data: props,\n  }));\n\n  const roots = appointmentNodes.reduce((acc, appointment, appointmentIndex) => {\n    const { offset: appointmentOffset } = appointment.data;\n\n    if (appointmentOffset === 0) {\n      if (appointmentIndex + 1 === appointmentNodes.length) {\n        appointment.children = [];\n        appointment.hasDirectChild = false;\n        appointment.treeDepth = 0;\n      } else {\n        appointment.treeDepth = visitAllChildren(\n          appointmentNodes, appointmentIndex, cellDuration, 0,\n        );\n      }\n\n      appointment.parent = undefined;\n      appointment.isDirectChild = false;\n      return [...acc, appointmentIndex];\n    }\n    return acc;\n  }, []);\n  return { appointments: appointmentNodes, roots };\n};\n\nconst visitChild: VisitChildFn = (\n  appointmentNodes, index, parentAppointmentIndex, cellDuration, isDirectChild, treeDepth,\n) => {\n  const appointmentNode = appointmentNodes[index];\n  appointmentNode.isDirectChild = isDirectChild;\n  appointmentNode.parent = parentAppointmentIndex;\n  const nextTreeDepth = treeDepth + 1;\n  const { end } = appointmentNode.data;\n\n  if (index === appointmentNodes.length - 1\n    || end.isSameOrBefore(appointmentNodes[index + 1].data.start)) {\n    appointmentNode.children = [];\n    appointmentNode.treeDepth = 0;\n    appointmentNode.hasDirectChild = false;\n    return nextTreeDepth;\n  }\n\n  const calculatedTreeDepth = visitAllChildren(\n    appointmentNodes, index, cellDuration, treeDepth,\n  );\n\n  appointmentNode.treeDepth = calculatedTreeDepth;\n  return calculatedTreeDepth + 1;\n};\n\nconst visitAllChildren: VisitAllChildrenFn = (\n  appointmentNodes, appointmentIndex, cellDuration, treeDepth,\n) => {\n  const appointment = appointmentNodes[appointmentIndex];\n  const { end, offset: appointmentOffset, start } = appointment.data;\n  const directChildTimeLimit = moment(start).add(cellDuration, 'minutes');\n  let maxAppointmentTreeDepth = 0;\n  const children = [] as AppointmentIndex[];\n\n  let nextChildIndex = appointmentIndex + 1;\n  while (isPossibleChild(appointmentNodes, nextChildIndex, end, appointmentOffset)) {\n    const nextAppointment = appointmentNodes[nextChildIndex];\n    const { offset: nextOffset, start: nextStart } = nextAppointment.data;\n\n    if (nextOffset === appointmentOffset + 1) {\n      const isDirectChild = intervalIncludes(start, directChildTimeLimit, nextStart);\n      const nextTreeDepth = visitChild(\n        appointmentNodes, nextChildIndex, appointmentIndex, cellDuration, isDirectChild, treeDepth,\n      );\n\n      if (maxAppointmentTreeDepth < nextTreeDepth) {\n        maxAppointmentTreeDepth = nextTreeDepth;\n      }\n      children.push(nextChildIndex);\n    }\n    nextChildIndex += 1;\n  }\n  appointment.hasDirectChild = children.length !== 0 && appointmentNodes[children[0]].isDirectChild;\n  appointment.children = children;\n\n  return maxAppointmentTreeDepth;\n};\n\nexport const isPossibleChild: IsPossibleChildFn = (\n  appointments, possibleChildIndex, parentEnd, parentOffset,\n) => {\n  const possibleChild = appointments[possibleChildIndex];\n  return (\n    possibleChildIndex < appointments.length\n    && possibleChild.data.offset !== parentOffset\n    && possibleChild.data.start.isBefore(parentEnd)\n  );\n};\n\nexport const findMaxReduceValue: FindMaxReduceValueFn =\n  appointmentGroups => appointmentGroups.reduce((maxReduceValue, group) => {\n    const currentReduceValue = group.reduceValue;\n    return maxReduceValue > currentReduceValue ? maxReduceValue : currentReduceValue;\n  }, 1);\n\nexport const calculateAppointmentsMetaData: CalculateAppointmentsMetaDataFn = (\n  appointmentGroups, indirectChildLeftOffset,\n) => appointmentGroups.map((appointmentForest) => {\n  const { items, roots } = appointmentForest;\n  const firstNode = items[0];\n  return {\n    ...appointmentForest,\n    items: items.length === 1\n      ? [{\n        ...firstNode,\n        data: {\n          ...firstNode.data,\n          left: 0,\n          width: 1,\n        },\n      }]\n      : calculateRootsMetaData(items, roots, indirectChildLeftOffset) as CalculatedTreeNode[],\n  };\n});\n\nconst calculateRootsMetaData: CalulateRootsMetaDataFn = (\n  appointmentNodes, roots, indirectChildLeftOffset,\n) => {\n  const appointments = appointmentNodes.map(props => ({ ...props })) as CalculatedTreeNode[];\n\n  roots.forEach((appointmentIndex) => {\n    const appointment = appointments[appointmentIndex];\n    const { left, width } = calculateAppointmentLeftAndWidth(\n      appointments, undefined, appointment, MAX_WIDTH, indirectChildLeftOffset, undefined,\n    );\n    appointment.data.left = left;\n    appointment.data.width = width;\n    calculateChildrenMetaData(appointments, appointment, MAX_WIDTH, indirectChildLeftOffset);\n  });\n  return appointments;\n};\n\nconst calculateChildMetaData: CalculateChildMetaDataFn = (\n  appointmentNodes, appointmentIndex, maxWidth, indirectChildLeftOffset,\n) => {\n  const appointment = appointmentNodes[appointmentIndex];\n  const { left, width } = calculateAppointmentLeftAndWidth(\n    appointmentNodes, undefined, appointment, maxWidth, indirectChildLeftOffset, undefined,\n  );\n  appointment.data.left = left;\n  appointment.data.width = width;\n\n  calculateChildrenMetaData(\n    appointmentNodes, appointment, maxWidth, indirectChildLeftOffset,\n  );\n};\n\nconst calculateChildrenMetaData: CalculateChildrenMetaDataFn = (\n  appointmentNodes, appointmentNode, maxWidth, indirectChildLeftOffset,\n) => {\n  appointmentNode.children.forEach((childIndex) => {\n    calculateChildMetaData(appointmentNodes, childIndex, maxWidth, indirectChildLeftOffset);\n  });\n};\n\nexport const calculateAppointmentLeftAndWidth: CalculateAppointmentLeftAndWidthFn = (\n  appointmentNodes, blocks, appointmentNode, maxRight, indirectChildLeftOffset, defaultLeft,\n) => {\n  const {\n    hasDirectChild, treeDepth, isDirectChild, parent: parentIndex, children, blockIndex,\n  } = appointmentNode as TreeNodeInBlock;\n  const firstChild = appointmentNodes[children[0]];\n  const firstChildBlockIndex = (firstChild as TreeNodeInBlock)?.blockIndex;\n\n  const hasDirectChildAndInSameBlock = hasDirectChild\n    && (firstChildBlockIndex === undefined || (blockIndex === firstChildBlockIndex\n      || blocks![firstChildBlockIndex].includedInto === blockIndex\n      || maxRight === 1));\n\n  if (parentIndex === undefined) {\n    return ({\n      width: hasDirectChildAndInSameBlock ? maxRight / (treeDepth + 1) : maxRight,\n      left: 0,\n    });\n  }\n\n  const parent = appointmentNodes[parentIndex];\n  const {\n    width: parentWidth,\n    left: parentLeft,\n  } = parent.data;\n  const calculatedLeft = isDirectChild\n    ? parentLeft + parentWidth : parentLeft + indirectChildLeftOffset;\n  const left = defaultLeft !== undefined ? Math.max(defaultLeft, calculatedLeft) : calculatedLeft;\n  const unoccupiedSpace = maxRight - left;\n\n  return ({\n    width: hasDirectChildAndInSameBlock ? unoccupiedSpace / (treeDepth + 1) : unoccupiedSpace,\n    left,\n  });\n};\n\nexport const prepareToGroupIntoBlocks: PrepareToGroupIntoBlocksFn =\n  appointments => appointments.map((appointmentForest) => {\n    const { items: nodes } = appointmentForest;\n    const appointmentNodes = nodes.map(props => ({\n      ...props,\n    })) as TreeNodeWithOverlappingSubTreeRoots[];\n\n    appointmentNodes.forEach((appointmentNode, index) => {\n      if (index === 0) {\n        appointmentNode.overlappingSubTreeRoots = [];\n        return;\n      }\n      const overlappingSubTreeRoots = [] as any[];\n      const { offset: appointmentOffset, end } = appointmentNode.data;\n\n      let nextChildIndex = index + 1;\n      let currentBlockEnd;\n      while (isPossibleChild(appointmentNodes, nextChildIndex, end, appointmentOffset)) {\n        const nextAppointment = appointmentNodes[nextChildIndex];\n        if (nextAppointment.data.offset < appointmentOffset\n          && nextAppointment.maxOffset === undefined) {\n          nextAppointment.maxOffset = appointmentOffset;\n        }\n\n        const previousSubTreeRoot = overlappingSubTreeRoots.length > 0\n          ? appointmentNodes[overlappingSubTreeRoots[overlappingSubTreeRoots.length - 1]]\n          : undefined;\n        if (isOverlappingSubTreeRoot(\n          appointmentNode, nextAppointment, previousSubTreeRoot, currentBlockEnd,\n        )) {\n          overlappingSubTreeRoots.push(nextChildIndex);\n          nextAppointment.overlappingSubTreeRoot = true;\n          const maxChildDate = findChildrenMaxEndDate(appointmentNodes, nextAppointment);\n          if (!currentBlockEnd || currentBlockEnd.isBefore(maxChildDate)) {\n            currentBlockEnd = maxChildDate;\n          }\n        }\n        nextChildIndex += 1;\n      }\n      appointmentNode.overlappingSubTreeRoots = overlappingSubTreeRoots;\n    });\n    return {\n      ...appointmentForest,\n      items: appointmentNodes,\n    };\n  });\n\nexport const isOverlappingSubTreeRoot: IsOverlappingSubTreeRootFn = (\n  appointmentNode, nextAppointment, previousSubTreeRoot, previousEndDate,\n) => {\n  const {\n    overlappingSubTreeRoot, maxOffset, data: nextData,\n  } = nextAppointment;\n  const { offset: nextOffset, start: nextStart } = nextData;\n  const { offset } = appointmentNode.data;\n\n  return (\n    nextOffset < offset\n      && !overlappingSubTreeRoot\n      && (maxOffset === undefined || maxOffset >= offset)\n      && (!previousSubTreeRoot\n        || (previousSubTreeRoot.data.offset >= nextOffset\n        && nextStart.isSameOrAfter(previousEndDate)))\n  );\n};\n\nexport const findChildrenMaxEndDate: FindChildrenMaxEndDateFn = (\n  appointmentNodes, appointmentNode,\n) => {\n  const { children, data } = appointmentNode;\n  const { end } = data;\n\n  const maxDate = children.reduce((currentMaxDate, childIndex) => {\n    const child = appointmentNodes[childIndex];\n    const maxChildrenDate = findChildrenMaxEndDate(appointmentNodes, child);\n    if (maxChildrenDate.isAfter(currentMaxDate)) {\n      return maxChildrenDate;\n    }\n    return currentMaxDate;\n  }, end);\n  return maxDate;\n};\n\nexport const groupAppointmentsIntoBlocks: GroupAppointmentsIntoBlocksFn =\n  appointmentForests => appointmentForests.map((appointmentForest) => {\n    const { items, reduceValue } = appointmentForest;\n    const { blocks: nextBlocks, appointments } = items.reduce((acc, appointment, index) => {\n      const blocks = acc.blocks.slice();\n      const {\n        treeDepth, data, overlappingSubTreeRoots,\n      } = appointment;\n      const { offset, start, end } = data;\n      let blockIndex = findBlockIndexByAppointment(blocks, appointment);\n\n      if (blockIndex < 0) {\n        blocks.push({\n          start, end, minOffset: offset, maxOffset: offset + treeDepth,\n          size: treeDepth + 1, items: [], endForChildren: end,\n        });\n        blockIndex = blocks.length - 1;\n      }\n\n      blocks[blockIndex].items.push(index);\n\n      overlappingSubTreeRoots.forEach((subTreeRootIndex) => {\n        const subTreeRoot = items[subTreeRootIndex];\n        const { data: subTreeRootData } = subTreeRoot;\n        blocks.push({\n          start: subTreeRootData.start, end,\n          minOffset: subTreeRootData.offset, maxOffset: offset - 1,\n          size: calculateBlockSizeByEndDate(items, subTreeRoot, end), items: [],\n          endForChildren: subTreeRootData.end,\n        });\n      });\n      const appointmentInBlock = { ...appointment, blockIndex };\n\n      return {\n        blocks,\n        appointments: [...acc.appointments, appointmentInBlock],\n      };\n    }, {\n      blocks: [{\n        start: items[0].data.start,\n        end: items[0].data.end,\n        minOffset: 0,\n        maxOffset: reduceValue - 1,\n        size: reduceValue,\n        items: [],\n        endForChildren: items[0].data.end,\n      }] as AppointmentBlock[],\n      appointments: [] as TreeNodeInBlock[],\n    });\n    return {\n      blocks: nextBlocks,\n      appointmentForest: {\n        ...appointmentForest,\n        items: appointments,\n      },\n    };\n  });\n\nconst calculateBlockSizeByEndDate: CalculateBlockSizeBEndDateFn = (\n  appointmentNodes, subTreeRoot, blockEndDate,\n) => {\n  const { children, data } = subTreeRoot;\n  const { start } = data;\n\n  if (children.length === 0) {\n    if (blockEndDate.isAfter(start)) {\n      return 1;\n    }\n    return 0;\n  }\n  const maxSize = Math.max(\n    ...children.map(childIndex => calculateBlockSizeByEndDate(\n      appointmentNodes, appointmentNodes[childIndex], blockEndDate),\n    ),\n  );\n\n  if (blockEndDate.isSameOrBefore(start) && maxSize === 0) {\n    return 0;\n  }\n  return maxSize + 1;\n};\n\nexport const findBlockIndexByAppointment: FindBlockIndexByAppointmentFn = (\n  blocks, appointment,\n) => {\n  const { start, offset } = appointment.data;\n\n  let blockIndex = blocks.length - 1;\n  while (blockIndex >= 0) {\n    const currentBlock = blocks[blockIndex];\n    if (intervalIncludes(currentBlock.start, currentBlock.end, start)\n      && offset >= currentBlock.minOffset && offset <= currentBlock.maxOffset &&\n      (!appointment.overlappingSubTreeRoot ||\n        appointment.overlappingSubTreeRoot && !currentBlock.items.length)\n    ) {\n      break;\n    }\n    blockIndex -= 1;\n  }\n\n  return blockIndex;\n};\n\nexport const findIncludedBlocks: FindIncludedBlocksFn = (groupedIntoBlocks) => {\n  return groupedIntoBlocks.map(({ blocks, appointmentForest }) => {\n    const nextBlocks = blocks.map(props => ({ ...props })) as IncludedBlock[];\n\n    nextBlocks.forEach((block, blockIndex) => {\n      block.includedBlocks = [];\n      for (\n        let currentBlockIndex = blockIndex + 1;\n        currentBlockIndex < nextBlocks.length;\n        currentBlockIndex += 1\n      ) {\n        const currentBlock = nextBlocks[currentBlockIndex];\n        if (isIncludedBlock(block, currentBlock)) {\n          block.includedBlocks.push(currentBlockIndex);\n          currentBlock.includedInto = blockIndex;\n        }\n      }\n    });\n    return {\n      blocks: nextBlocks, appointmentForest,\n    };\n  });\n};\n\nconst isIncludedBlock: IsIncludedBlockFn = (block, possibleIncludedBlock) => {\n  const { start, end, minOffset, maxOffset } = block;\n  const {\n    start: possibleIncludedStart, end: possibleIncludedEnd,\n    minOffset: possibleMinOffset, maxOffset: possibleMaxOffset,\n  } = possibleIncludedBlock;\n  return intervalIncludes(start, end, possibleIncludedStart)\n    && intervalIncludes(start, end, possibleIncludedEnd)\n    && possibleMaxOffset <= maxOffset && possibleMinOffset >= minOffset;\n};\n\nexport const findChildBlocks: FindChildBlocksFn = (groupedIntoBlocks) => {\n  return groupedIntoBlocks.map(({ blocks, appointmentForest }) => {\n    const nextBlocks = blocks.map(props => ({ ...props })) as BlockWithChildren[];\n\n    nextBlocks.forEach((block, index) => {\n      block.children = [];\n      for (let currentIndex = index + 1; currentIndex < nextBlocks.length; currentIndex += 1) {\n        const nextBlock = nextBlocks[currentIndex];\n\n        if (isChildBlock(block, nextBlock)) {\n          block.children.push(currentIndex);\n          nextBlock.parent = index;\n        }\n      }\n      return block;\n    });\n    return {\n      appointmentForest, blocks: nextBlocks,\n    };\n  });\n};\n\nconst isChildBlock: IsChildBlockFn = (block, possibleChildBlock) => {\n  const { start, endForChildren, minOffset, includedInto } = block;\n  const {\n    start: childStart, includedInto: childIncludedInto, maxOffset: childMaxOffset,\n  } = possibleChildBlock;\n  return intervalIncludes(start, endForChildren, childStart)\n    && childMaxOffset + 1 === minOffset\n    && (\n      childIncludedInto === undefined\n      || childIncludedInto === includedInto\n    );\n};\n\nexport const adjustByBlocks: AdjustByBlocksFn = (\n  groupedIntoBlocks, indirectChildLeftOffset,\n) => {\n  const updatedBlocks = groupedIntoBlocks.map(({ blocks, appointmentForest }) => {\n    const dimensionsCalculated = calculateBlocksDimensions(blocks, appointmentForest.items);\n\n    return {\n      blocks: alignBlocksWithPrevious(dimensionsCalculated, appointmentForest.items),\n      appointmentForest,\n    };\n  });\n  const adjustedByBlocks = updatedBlocks.map(({ blocks, appointmentForest }) => {\n    return {\n      ...appointmentForest,\n      items: adjustAppointmentsByBlocks(\n        appointmentForest.items, blocks, indirectChildLeftOffset,\n        ) as TreeNodeInBlock[],\n    };\n  });\n  return adjustedByBlocks;\n};\n\nconst calculateBlocksDimensions: CalculateBlockDimensionsFn = (\n  blocks, appointments,\n) => updateBlocksProportions(calculateBlocksLeftLimit(\n  calculateBlocksTotalSize(blocks), appointments,\n));\n\nconst alignBlocksWithPrevious: AlignBlocksWithPreviousFn = (blocks, appointments) => {\n  const nextBlocks = blocks.map(({ right, ...restProps }) => ({ ...restProps }));\n\n  const leftLimitCalculated = calculateBlocksLeftLimit(\n    updateBlocksLeft(nextBlocks as CalculatedBlock[], appointments), appointments,\n  );\n  return updateBlocksProportions(leftLimitCalculated);\n};\n\nconst adjustAppointmentsByBlocks: AdjustAppointemntsByBlocksFn = (\n  appointments, blocks, indirectChildLeftOffset,\n) => {\n  const nextAppointments = appointments.map(props => ({ ...props }));\n  const nextBlocks = blocks.map(props => ({ ...props }));\n\n  nextBlocks.forEach((block, index) => {\n    if (index !== 0) {\n      const { items, left: blockLeft, right, children } = block;\n      const maxRight = calculateIncludedBlockMaxRight(nextBlocks, block);\n      const finalMaxRight = maxRight * right;\n      const defaultLeft = blockLeft! * maxRight;\n\n      items.forEach((appointmentIndex, itemIndex) => {\n        const appointment = nextAppointments[appointmentIndex];\n        if (itemIndex === 0) {\n          const { left, width } = calculateAppointmentLeftAndWidth(\n            nextAppointments, nextBlocks, appointment,\n            finalMaxRight, indirectChildLeftOffset, defaultLeft,\n          );\n          appointment.data.left = left;\n          appointment.data.width = width;\n          if (defaultLeft !== left) {\n            children.forEach((childIndex) => {\n              redistributeChildBlocks(nextBlocks, childIndex, left / maxRight);\n            });\n          }\n        } else {\n          const {\n            left, width,\n          } = calculateAppointmentLeftAndWidth(\n            nextAppointments, nextBlocks, appointment,\n            finalMaxRight, indirectChildLeftOffset, undefined,\n          );\n          appointment.data.left = left;\n          appointment.data.width = width;\n        }\n      });\n    }\n  });\n  blocks[0].items.forEach((appointmentIndex) => {\n    const appointment = nextAppointments[appointmentIndex];\n    const {\n      left, width,\n    } = calculateAppointmentLeftAndWidth(\n      nextAppointments, blocks, appointment, 1, indirectChildLeftOffset, undefined,\n    );\n    appointment.data.left = left;\n    appointment.data.width = width;\n  });\n  return nextAppointments;\n};\n\nconst redistributeChildBlocks: RedistributeBlocksFn = (blocks, blockIndex, right) => {\n  const block = blocks[blockIndex];\n  const { leftOffset, size, leftLimit, children } = block;\n  block.right = right;\n  const width = size + leftOffset;\n  const relativeWidth = right - leftLimit;\n  const left = right - relativeWidth * size / width;\n  block.left = left;\n  children.forEach((childIndex) => {\n    redistributeChildBlocks(blocks, childIndex, left);\n  });\n};\n\nexport const calculateIncludedBlockMaxRight: CalculateIncludedBlockMaxRightFn = (\n  blocks, includedBlock,\n) => {\n  const { includedInto: includedIntoIndex } = includedBlock;\n  if (includedIntoIndex === undefined) {\n    return 1;\n  }\n\n  const includedInto = blocks[includedIntoIndex];\n  const currentMaxRight = includedInto.right;\n  return currentMaxRight * calculateIncludedBlockMaxRight(blocks, includedInto);\n\n};\n\nexport const calculateBlocksTotalSize: CalculateBlocksTotalSizeFn = (blocks) => {\n  const result = blocks.map((block) => {\n    const totalSize = calculateSingleBlockTotalSize(blocks, block);\n    return {\n      ...block,\n      totalSize,\n      leftOffset: totalSize - block.size,\n    };\n  });\n  return result;\n};\n\nconst calculateSingleBlockTotalSize: CalculateSingleBlockTotalSizeFn = (\n  blocks, block,\n) => {\n  const { children, size } = block;\n  if (children.length === 0) {\n    return size;\n  }\n  return Math.max(\n    ...children.map(childIndex => calculateSingleBlockTotalSize(blocks, blocks[childIndex])),\n  ) + size;\n};\n\nexport const calculateBlocksLeftLimit: CalculateBlocksLeftLimitFn = (\n  blocks, appointments,\n) => (blocks as CalculatedBlock[]).map((block) => {\n  const leftLimit = calculateSingleBlockLeftLimit(blocks, appointments, block);\n  return {\n    ...block,\n    leftLimit,\n  };\n});\n\nconst calculateSingleBlockLeftLimit: CalculateSingleBlockLeftLimitFn = (\n  blocks, appointments, block,\n) => {\n  const { children, items, left } = block as CalculatedBlock;\n  if (children.length === 0) {\n    return left !== undefined\n      ? Math.min(left, appointments[items[0]].data.left)\n      : appointments[items[0]].data.left;\n  }\n  return Math.min(\n    ...children.map(childIndex => calculateSingleBlockLeftLimit(\n      blocks, appointments, blocks[childIndex],\n    )),\n  );\n};\n\nexport const updateBlocksProportions: UpdateBlocksProportionsFn = (blocks) => {\n  const nextBlocks = (blocks as CalculatedBlock[]).map(props => ({ ...props }));\n\n  nextBlocks.forEach((block) => {\n    const { parent: parentIndex, leftLimit, leftOffset, totalSize } = block;\n    if (parentIndex === undefined) {\n      block.right = 1;\n      block.left = (1 - leftLimit) * leftOffset / totalSize + leftLimit;\n      return;\n    }\n\n    const parent = nextBlocks[parentIndex];\n    const { left: parentLeft, totalSize: parentTotalSize } = parent as CalculatedBlock;\n    block.totalSize = parentTotalSize;\n    block.right = parentLeft as number;\n    block.left = (1 - leftLimit) * leftOffset / parentTotalSize + leftLimit;\n  });\n\n  return nextBlocks;\n};\n\nexport const updateBlocksLeft: UpdateBlocksLeftFn = (\n  blocks, appointments,\n) => blocks.map((block) => {\n  const { items, left } = block;\n  const firstItem = appointments[items[0]];\n  const { parent: firstItemParentIndex } = firstItem;\n  if (firstItemParentIndex === undefined) {\n    return block;\n  }\n\n  const firstItemParent = appointments[firstItemParentIndex];\n  const parentBlock = blocks[firstItemParent.blockIndex];\n\n  return {\n    ...block,\n    left: parentBlock.parent === undefined ? left : blocks[parentBlock.parent].left,\n  };\n});\n\nconst createAndAdjustAppointmentForest: CreateAndAdjustAppointmentForestFn = (\n  appointmentGroups, cellDuration,\n) => {\n  const appointmentForest = createAppointmentForest(appointmentGroups, cellDuration);\n  const indirectChildLeftOffset = Math.min(\n    1 / findMaxReduceValue(appointmentForest),\n    INDIRECT_CHILD_LEFT_OFFSET,\n  );\n  const baseCalculated = calculateAppointmentsMetaData(\n    appointmentForest, indirectChildLeftOffset,\n  );\n\n  const preparedToGroupIntoBlocks = prepareToGroupIntoBlocks(baseCalculated);\n  const groupedIntoBlocks = groupAppointmentsIntoBlocks(preparedToGroupIntoBlocks);\n  const blocksWithIncluded = findIncludedBlocks(groupedIntoBlocks);\n  const blocksWithParents = findChildBlocks(blocksWithIncluded);\n  return adjustByBlocks(blocksWithParents, indirectChildLeftOffset);\n};\n\nexport const calculateRectByDateAndGroupIntervals: CalculateRectByDateAndGroupIntervalsFn = (\n  type, intervals, rectByDates, rectByDatesMeta, viewMetaData,\n) => {\n  const { growDirection, multiline } = type;\n  const isHorizontal = growDirection === HORIZONTAL_TYPE;\n\n  const sorted = intervals.map(sortAppointments);\n  const grouped = sorted.reduce(((acc, sortedGroup) => [\n    ...acc,\n    ...findOverlappedAppointments(sortedGroup as AppointmentMoment[], isHorizontal),\n  ]), [] as AppointmentMoment[]);\n\n  const { cellDuration, placeAppointmentsNextToEachOther } = rectByDatesMeta;\n  const rectCalculator = isHorizontal\n    ? horizontalRectCalculator\n    : placeAppointmentsNextToEachOther ? oldVerticalRectCalculator : verticalRectCalculator;\n\n  const groupsCalculated = calculateAppointmentOffsets(\n    grouped as any[], isHorizontal,\n  );\n  const isAppointmentForestNeeded = !isHorizontal && !placeAppointmentsNextToEachOther;\n  let appointmentForest: GroupedIntoBlocksForest[];\n\n  if (isAppointmentForestNeeded) {\n    appointmentForest = createAndAdjustAppointmentForest(\n      groupsCalculated as AppointmentGroup[], cellDuration,\n    ) as GroupedIntoBlocksForest[];\n  }\n\n  const unwrappedAppointments = isAppointmentForestNeeded\n    ? unwrapAppointmentForest(appointmentForest!)\n    : unwrapGroups(groupsCalculated);\n  const rects = unwrappedAppointments.map(appointment => rectCalculator(\n    appointment, viewMetaData,\n    { rectByDates, multiline, rectByDatesMeta },\n  ));\n  return rects.sort((first, second) => first.offset! >= second.offset! ? 1 : -1);\n};\n","import moment from 'moment';\nimport { PureComputed } from '@devexpress/dx-core';\nimport {\n  AppointmentMoment, DayBoundaryPredicateFn,\n  ReduceAppointmentByDayBoundsFn, NormalizeAppointmentDurationFn, ViewCell, SchedulerDateTime,\n} from '../../types';\nimport { checkCellGroupingInfo } from '../common/helpers';\nimport { addDateToKey } from '../../utils';\n\nexport const sliceAppointmentByDay: PureComputed<\n  [AppointmentMoment, number], AppointmentMoment[]\n> = (appointment, cellDuration) => {\n  const { start, end, dataItem, key } = appointment;\n  if (start.isSame(end, 'day')) return [appointment];\n\n  const minDuration = cellDuration / 2;\n  const isShortOnFirstDay = start.clone().endOf('day').diff(start, 'minutes') < minDuration;\n  const isShortOnSecondDay = end.clone().diff(end.clone().startOf('day'), 'minutes') < minDuration;\n  const firstAppointmentKey = addDateToKey(key, start);\n  const secondAppointmentKey = addDateToKey(key, end);\n\n  return [\n    isShortOnFirstDay ? {\n      start: start.clone().endOf('day').add(-minDuration, 'minutes'),\n      end: start.clone().endOf('day'),\n      dataItem,\n      key: firstAppointmentKey,\n    } : {\n      start, end: start.clone().endOf('day'), dataItem,\n      key: firstAppointmentKey,\n    },\n    isShortOnSecondDay ? {\n      start: end.clone().startOf('day'),\n      end: end.clone().startOf('day').add(minDuration, 'minutes'),\n      dataItem,\n      key: secondAppointmentKey,\n    } : {\n      start: end.clone().startOf('day'), end, dataItem,\n      key: secondAppointmentKey,\n    },\n  ];\n};\n\nexport const dayBoundaryPredicate: DayBoundaryPredicateFn = (\n  appointment,\n  leftBound, rightBound,\n  excludedDays = [],\n) => {\n  const dayStart = moment(leftBound as Date);\n  const dayEnd = moment(rightBound as Date);\n  const startDayTime = moment(appointment.start)\n    .hour(dayStart.hour())\n    .minutes(dayStart.minutes());\n  const endDayTime = moment(appointment.start)\n    .hour(dayEnd.hour())\n    .minutes(dayEnd.minutes());\n\n  if (appointment.end.isBefore(dayStart) || appointment.start.isAfter(dayEnd)) return false;\n  if (excludedDays.findIndex(day => day === moment(appointment.start).day()) !== -1) return false;\n  return (appointment.end.isAfter(startDayTime)\n    && appointment.start.isBefore(endDayTime));\n};\n\nexport const reduceAppointmentByDayBounds: ReduceAppointmentByDayBoundsFn = (\n  appointment, leftBound, rightBound, cellDuration,\n) => {\n  const dayStart = moment(leftBound as Date);\n  const dayEnd = moment(rightBound as Date);\n  const startDayTime = moment(appointment.start)\n    .hour(dayStart.hour())\n    .minutes(dayStart.minutes())\n    .seconds(dayStart.seconds());\n  const endDayTime = moment(appointment.start)\n    .hour(dayEnd.hour())\n    .minutes(dayEnd.minutes())\n    .seconds(dayEnd.seconds());\n\n  const minDuration = cellDuration / 2;\n  const isShortOnFirstDay = endDayTime.clone().diff(appointment.start, 'minutes') < minDuration;\n  const isShortOnSecondDay = appointment.end.clone().diff(startDayTime, 'minutes') < minDuration;\n\n  if (isShortOnFirstDay) {\n    return {\n      ...appointment, start: endDayTime.clone().add(-minDuration, 'minutes'), end: endDayTime,\n    };\n  }\n\n  if (isShortOnSecondDay) {\n    return {\n      ...appointment, start: startDayTime, end: startDayTime.clone().add(minDuration, 'minutes'),\n    };\n  }\n\n  return {\n    ...appointment,\n    ...(appointment.start.isSameOrBefore(startDayTime) ? { start: startDayTime } : null),\n    ...(appointment.end.isSameOrAfter(endDayTime) ? { end: endDayTime } : null),\n  };\n};\n\nexport const normalizeAppointmentDuration: NormalizeAppointmentDurationFn = (\n  appointment, cellDuration,\n) => {\n  const minDuration = cellDuration / 2;\n  const start = moment(appointment.start as Date);\n  const end = moment(appointment.end as Date);\n\n  if (end.diff(start, 'minutes') > minDuration) {\n    return { ...appointment, start, end };\n  }\n\n  if (end.isSame(start.clone().add(minDuration, 'minutes'), 'day')) {\n    return { ...appointment, start, end: start.clone().add(minDuration, 'minutes') };\n  }\n\n  return {\n    ...appointment,\n    start: start.clone().endOf('day').add(-minDuration, 'minutes'),\n    end: start.clone().endOf('day'),\n  };\n};\n\nexport const getWeekVerticallyGroupedColumnIndex: PureComputed<\n  [ViewCell[][], SchedulerDateTime], number\n> = (viewCellsData, date) =>  viewCellsData[0].findIndex((\n  timeCell: ViewCell,\n) => moment(date as SchedulerDateTime).isSame(timeCell.startDate, 'date'));\n\nexport const getWeekHorizontallyGroupedColumnIndex: PureComputed<\n  [ViewCell[][], AppointmentMoment, SchedulerDateTime], number\n> = (viewCellsData, appointment, date) => viewCellsData[0].findIndex((timeCell: ViewCell) => {\n  const isCorrectGroup = checkCellGroupingInfo(timeCell, appointment);\n  return moment(date as SchedulerDateTime).isSame(timeCell.startDate, 'date') && isCorrectGroup;\n});\n\nexport const getWeekVerticallyGroupedRowIndex: PureComputed<\n  [ViewCell[][], AppointmentMoment, SchedulerDateTime, number, boolean, number], number\n> = (viewCellsData, appointment, date, columnIndex, takePrev, groupCount) => {\n  const timeTableHeight = viewCellsData.length / groupCount;\n  let timeTableRowIndex = getWeekHorizontallyGroupedRowIndex(\n    viewCellsData, date, columnIndex, takePrev,\n  );\n\n  if (!viewCellsData[0][0].groupingInfo) return timeTableRowIndex;\n\n  let isWrongCell = !checkCellGroupingInfo(\n    viewCellsData[timeTableRowIndex][columnIndex], appointment,\n  );\n  while (isWrongCell) {\n    timeTableRowIndex += timeTableHeight;\n    isWrongCell = !checkCellGroupingInfo(\n      viewCellsData[timeTableRowIndex][columnIndex], appointment,\n    );\n  }\n  return timeTableRowIndex;\n};\n\nexport const getWeekHorizontallyGroupedRowIndex: PureComputed<\n  [ViewCell[][], SchedulerDateTime, number, boolean], number\n> = (viewCellsData, date, columnIndex, takePrev) => viewCellsData.findIndex(\n  timeCell => moment(date as SchedulerDateTime)\n    .isBetween(\n      timeCell[columnIndex].startDate,\n      timeCell[columnIndex].endDate,\n      'seconds',\n      takePrev ? '(]' : '[)'),\n    );\n","import { CalculateWeekDateIntervalsFn, AppointmentMoment } from '../../types';\nimport {\n  sliceAppointmentByDay, dayBoundaryPredicate, reduceAppointmentByDayBounds,\n  normalizeAppointmentDuration,\n} from './helpers';\nimport { filterByViewBoundaries } from '../../utils';\n\nexport const calculateWeekDateIntervals: CalculateWeekDateIntervalsFn = (\n  appointments,\n  leftBound, rightBound, // startViewDate, endViewDate\n  excludedDays,\n  cellDuration,\n) => [\n  appointments\n    .map(appointment => normalizeAppointmentDuration(appointment, cellDuration))\n    .reduce((acc, appointment) =>\n      [...acc, ...filterByViewBoundaries(appointment, leftBound, rightBound, excludedDays, true)],\n      [] as AppointmentMoment[],\n    )\n    .reduce((acc, appointment) => (\n      [...acc, ...sliceAppointmentByDay(appointment, cellDuration)]), [] as AppointmentMoment[],\n    )\n    .filter(appointment => dayBoundaryPredicate(appointment, leftBound, rightBound, excludedDays))\n    .map(appointment => reduceAppointmentByDayBounds(\n      appointment, leftBound, rightBound, cellDuration,\n    )),\n];\n","import moment from 'moment';\nimport {\n  GetCellByAppointmentDataFn, GetVerticalRectByAppointmentDataFn,\n  GetCellRectVerticalFn, SchedulerDateTime,\n} from '../../types';\nimport { VERTICAL_GROUP_ORIENTATION } from '../../constants';\nimport {\n  getWeekHorizontallyGroupedRowIndex, getWeekVerticallyGroupedRowIndex,\n  getWeekHorizontallyGroupedColumnIndex, getWeekVerticallyGroupedColumnIndex,\n} from '../week-view/helpers';\n\nconst CELL_GAP_PX = 10;\nconst CELL_BOUND_HORIZONTAL_OFFSET_PX = 1;\nconst CELL_BOUND_VERTICAL_OFFSET_PX = 4;\n\nexport const getVerticalCellIndexByAppointmentData: GetCellByAppointmentDataFn = (\n  appointment, viewCellsData, viewMetaData, date, takePrev = false,\n) => {\n  const { groupOrientation, groupCount } = viewMetaData;\n\n  const columnIndex = groupOrientation === VERTICAL_GROUP_ORIENTATION\n    ? getWeekVerticallyGroupedColumnIndex(viewCellsData, date)\n    : getWeekHorizontallyGroupedColumnIndex(viewCellsData, appointment, date);\n  const rowIndex = groupOrientation === VERTICAL_GROUP_ORIENTATION\n    ? getWeekVerticallyGroupedRowIndex(\n      viewCellsData, appointment, date, columnIndex, takePrev, groupCount,\n    ) : getWeekHorizontallyGroupedRowIndex(viewCellsData, date, columnIndex, takePrev);\n\n  const cellIndex = (rowIndex * viewCellsData[0].length) + columnIndex;\n  return {\n    index: cellIndex,\n    startDate: viewCellsData[rowIndex][columnIndex].startDate,\n  };\n};\n\nconst getCellRect: GetCellRectVerticalFn = (\n  date, appointment, viewCellsData, cellDuration,\n  cellElementsMeta, takePrev, viewMetaData,\n) => {\n  const {\n    index: cellIndex,\n    startDate: cellStartDate,\n  } = getVerticalCellIndexByAppointmentData(\n    appointment, viewCellsData, viewMetaData, date, takePrev,\n  );\n\n  const {\n    top,\n    left,\n    width,\n    height: cellHeight,\n  } = cellElementsMeta.getCellRects[cellIndex]();\n  const timeOffset = moment(date as SchedulerDateTime).diff(cellStartDate as Date, 'minutes');\n  const topOffset = cellHeight * (timeOffset / cellDuration);\n  const parentRect = cellElementsMeta.parentRect();\n\n  return {\n    top,\n    left,\n    width,\n    topOffset,\n    parentRect,\n  };\n};\n\nexport const getVerticalRectByAppointmentData: GetVerticalRectByAppointmentDataFn = (\n  appointment,\n  viewMetaData,\n  {\n    viewCellsData,\n    cellDuration,\n    cellElementsMeta,\n    placeAppointmentsNextToEachOther,\n  },\n) => {\n  const firstCellRect = getCellRect(\n    appointment.start.toDate(), appointment, viewCellsData,\n    cellDuration, cellElementsMeta, false, viewMetaData,\n  );\n  const lastCellRect = getCellRect(\n    appointment.end.toDate(), appointment, viewCellsData,\n    cellDuration, cellElementsMeta, true, viewMetaData,\n  );\n\n  const top = firstCellRect.top + firstCellRect.topOffset;\n  const height = (lastCellRect.top + lastCellRect.topOffset) - top;\n\n  return {\n    width: firstCellRect.width - CELL_GAP_PX - CELL_BOUND_HORIZONTAL_OFFSET_PX,\n    top: top - firstCellRect.parentRect.top + CELL_BOUND_HORIZONTAL_OFFSET_PX,\n    left: firstCellRect.left - firstCellRect.parentRect.left + CELL_BOUND_HORIZONTAL_OFFSET_PX,\n    parentWidth: firstCellRect.parentRect.width,\n    height: placeAppointmentsNextToEachOther ? height - CELL_BOUND_VERTICAL_OFFSET_PX : height,\n  };\n};\n","import moment from 'moment';\nimport { PureComputed } from '@devexpress/dx-core';\nimport {\n  AppointmentMoment, GetAllDayCellIndexByAppointmentDataFn,\n  SliceAppointmentsByBoundariesFn, SchedulerDateTime, ViewCell,\n} from '../../types';\nimport { HORIZONTAL_GROUP_ORIENTATION } from '../../constants';\nimport { checkCellGroupingInfo } from '../common/helpers';\n\nexport const allDayPredicate: PureComputed<[AppointmentMoment], boolean> = appointment => (\n  appointment.end.diff(appointment.start, 'hours') > 23\n  || !!appointment.allDay\n);\n\nexport const getAllDayCellIndexByAppointmentData: GetAllDayCellIndexByAppointmentDataFn = (\n  viewCellsData, viewMetaData, date, appointment, takePrev,\n) => {\n  const currentDate = moment(date as SchedulerDateTime);\n  const { groupOrientation, groupCount } = viewMetaData;\n\n  const columnIndex = groupOrientation === HORIZONTAL_GROUP_ORIENTATION\n    ? getAllDayHorizontallyGroupedColumnIndex(viewCellsData, currentDate, appointment)\n    : getAllDayVerticallyGroupedColumnIndex(viewCellsData, currentDate);\n  const rowIndex = groupOrientation === HORIZONTAL_GROUP_ORIENTATION\n    ? 0 : getAllDayVerticallyGroupedRowIndex(viewCellsData, appointment, groupCount);\n\n  let cellIndex = rowIndex * viewCellsData[0].length + columnIndex;\n  if (takePrev && currentDate.format() === currentDate.startOf('day').format()) {\n    cellIndex -= 1;\n  }\n  return cellIndex;\n};\n\nexport const getAllDayVerticallyGroupedColumnIndex: PureComputed<\n  [ViewCell[][], moment.Moment], number\n> = (viewCellsData, date) => viewCellsData[0].findIndex((timeCell) => {\n  return date.isSame(timeCell.startDate, 'date');\n});\n\nexport const getAllDayHorizontallyGroupedColumnIndex: PureComputed<\n  [ViewCell[][], moment.Moment, AppointmentMoment], number\n> = (viewCellsData, date, appointment) => viewCellsData[0].findIndex(timeCell => (\n  date.isSame(timeCell.startDate, 'date') && checkCellGroupingInfo(timeCell, appointment)\n));\n\nexport const getAllDayVerticallyGroupedRowIndex: PureComputed<\n  [ViewCell[][], AppointmentMoment, number], number\n> = (viewCellsData, appointment, groupCount) => {\n  const index = viewCellsData.findIndex(viewCellsDataRow => checkCellGroupingInfo(\n    viewCellsDataRow[0], appointment,\n  ));\n  return index * groupCount / viewCellsData.length;\n};\n\nexport const sliceAppointmentsByBoundaries: SliceAppointmentsByBoundariesFn = (\n  appointment, left, right, excludedDays = [],\n) => {\n  const startDate = appointment.start.clone();\n  const endDate = appointment.end.clone();\n  let nextStart = startDate.clone();\n  let nextEnd = endDate.clone();\n\n  if (startDate.isBefore(left as Date)) {\n    nextStart = moment(left as Date);\n    nextStart.startOf('day');\n  }\n  if (endDate.isAfter(right as Date)) {\n    nextEnd = moment(right as Date);\n    nextEnd.endOf('day');\n  }\n  if (excludedDays.findIndex(day => day === startDate.day()) !== -1) {\n    while (excludedDays.findIndex(day => day === nextStart.day()) !== -1\n      && nextStart.isSameOrBefore(endDate, 'day')) {\n      nextStart.add(1, 'days').startOf('day');\n    }\n  }\n  if (excludedDays.findIndex(day => day === endDate.day()) !== -1) {\n    while (excludedDays.findIndex(day => day === nextEnd.day()) !== -1\n      && nextStart.isSameOrAfter(startDate, 'day')) {\n      nextEnd.add(-1, 'days').endOf('day');\n    }\n  }\n  return [{ ...appointment, start: nextStart, end: nextEnd }];\n};\n\nexport const sliceAppointmentsByDays: PureComputed<\n  [AppointmentMoment, number[]], AppointmentMoment[]\n> = (appointment, excludedDays = []) => {\n  const startDate = appointment.start;\n  const endDate = appointment.end;\n  let nextStart = startDate.clone();\n  const appointments = [] as AppointmentMoment[];\n\n  while (nextStart.isBefore(endDate)) {\n    if (excludedDays.findIndex(day => day === nextStart.day()) === - 1) {\n      appointments.push({\n        ...appointment,\n        start: nextStart,\n        end: moment(nextStart).endOf('day'),\n      });\n    }\n    nextStart = moment(nextStart).add(1, 'day');\n  }\n  return appointments;\n};\n","import { RRule } from 'rrule';\n\nexport const DEFAULT_RULE_OBJECT = {\n  interval: 1,\n};\n\nexport const DAYS_OF_WEEK = {\n  MONDAY: 0,\n  TUESDAY: 1,\n  WEDNESDAY: 2,\n  THURSDAY: 3,\n  FRIDAY: 4,\n  SATURDAY: 5,\n  SUNDAY: 6,\n};\n\nexport const RRULE_DAYS_OF_WEEK = [\n  RRule.MO,\n  RRule.TU,\n  RRule.WE,\n  RRule.TH,\n  RRule.FR,\n  RRule.SA,\n  RRule.SU,\n];\n\nexport const DAYS_IN_WEEK = 7;\n\nexport const DAYS_OF_WEEK_ARRAY = [\n  DAYS_OF_WEEK.SUNDAY, DAYS_OF_WEEK.MONDAY, DAYS_OF_WEEK.TUESDAY, DAYS_OF_WEEK.WEDNESDAY,\n  DAYS_OF_WEEK.THURSDAY, DAYS_OF_WEEK.FRIDAY, DAYS_OF_WEEK.SATURDAY,\n];\n\nexport const MONTHS = {\n  JANUARY: 1,\n  FEBRUARY: 2,\n  MARCH: 3,\n  APRIL: 4,\n  MAY: 5,\n  JUNE: 6,\n  JULY: 7,\n  AUGUST: 8,\n  SEPTEMBER: 9,\n  OCTOBER: 10,\n  NOVEMBER: 11,\n  DECEMBER: 12,\n};\n\nexport const RRULE_REPEAT_TYPES = {\n  YEARLY: RRule.YEARLY as number,\n  MONTHLY: RRule.MONTHLY as number,\n  WEEKLY: RRule.WEEKLY as number,\n  DAILY: RRule.DAILY as number,\n  HOURLY: RRule.HOURLY as number,\n  MINUTELY: RRule.MINUTELY as number,\n};\n\nexport const REPEAT_TYPES = {\n  DAILY: 'daily',\n  WEEKLY: 'weekly',\n  MONTHLY: 'monthly',\n  YEARLY: 'yearly',\n  NEVER: 'never',\n};\n\nexport const REPEAT_TYPES_ARRAY = [\n  REPEAT_TYPES.DAILY, REPEAT_TYPES.WEEKLY, REPEAT_TYPES.MONTHLY, REPEAT_TYPES.YEARLY,\n];\n\nexport const WEEK_NUMBER_LABELS = [\n  'firstLabel', 'secondLabel', 'thirdLabel', 'fourthLabel', 'lastLabel',\n];\n\nexport const END_REPEAT_RADIO_GROUP = 'endRepeat';\nexport const MONTHLY_RADIO_GROUP = 'monthlyRadioGroup';\nexport const YEARLY_RADIO_GROUP = 'yearlyRadioGroup';\n\nexport const TITLE_TEXT_EDITOR = 'titleTextEditor';\nexport const MULTILINE_TEXT_EDITOR = 'multilineTextEditor';\nexport const ORDINARY_TEXT_EDITOR = 'ordinaryTextEditor';\nexport const NUMBER_EDITOR = 'numberEditor';\n\nexport const TITLE = 'title';\nexport const ORDINARY_LABEL = 'ordinaryLabel';\n\nexport const SAVE_BUTTON = 'saveButton';\nexport const DELETE_BUTTON = 'deleteButton';\nexport const CANCEL_BUTTON = 'cancelButton';\n\nexport const OUTLINED_SELECT = 'outlinedSelect';\nexport const STANDARD_SELECT = 'standardSelect';\n\nexport const SUNDAY_DATE = new Date(2019, 7, 11);\nexport const MONDAY_DATE = new Date(2019, 7, 12);\nexport const TUESDAY_DATE = new Date(2019, 7, 13);\nexport const WEDNESDAY_DATE = new Date(2019, 7, 14);\nexport const THURSDAY_DATE = new Date(2019, 7, 15);\nexport const FRIDAY_DATE = new Date(2019, 7, 16);\nexport const SATURDAY_DATE = new Date(2019, 7, 17);\n\nexport const DAYS_OF_WEEK_DATES = [\n  SUNDAY_DATE, MONDAY_DATE, TUESDAY_DATE, WEDNESDAY_DATE,\n  THURSDAY_DATE, FRIDAY_DATE, SATURDAY_DATE,\n];\n\nexport const JANUARY_DATE = new Date(2019, 0, 1);\nexport const FEBRUARY_DATE = new Date(2019, 1, 1);\nexport const MARCH_DATE = new Date(2019, 2, 1);\nexport const APRIL_DATE = new Date(2019, 3, 1);\nexport const MAY_DATE = new Date(2019, 4, 1);\nexport const JUNE_DATE = new Date(2019, 5, 1);\nexport const JULY_DATE = new Date(2019, 6, 1);\nexport const AUGUST_DATE = new Date(2019, 7, 1);\nexport const SEPTEMBER_DATE = new Date(2019, 8, 1);\nexport const OCTOBER_DATE = new Date(2019, 9, 1);\nexport const NOVEMBER_DATE = new Date(2019, 10, 1);\nexport const DECEMBER_DATE = new Date(2019, 11, 1);\n\nexport const MONTHS_DATES = [\n  JANUARY_DATE, FEBRUARY_DATE, MARCH_DATE, APRIL_DATE, MAY_DATE, JUNE_DATE,\n  JULY_DATE, AUGUST_DATE, SEPTEMBER_DATE, OCTOBER_DATE, NOVEMBER_DATE, DECEMBER_DATE,\n];\n\nexport const FIRST_WEEK = 0;\nexport const SECOND_WEEK = 1;\nexport const THIRD_WEEK = 2;\nexport const FOURTH_WEEK = 3;\nexport const LAST_WEEK = 4;\n\nexport const BASIC_YEALY_COUNT = 5;\nexport const BASIC_MONTHLY_COUNT = 12;\nexport const BASIC_WEEKLY_COUNT = 13;\nexport const BASIC_DAILY_COUNT = 30;\n","import moment from 'moment';\nimport {\n  SliceAppointmentByWeekFn, GetMonthCellIndexByAppointmentDataFn,\n  SchedulerDateTime, AppointmentMoment, ViewCell,\n} from '../../types';\nimport { DAYS_IN_WEEK } from '../appointment-form/constants';\nimport { PureComputed } from '@devexpress/dx-core';\nimport { HORIZONTAL_GROUP_ORIENTATION } from '../../constants';\nimport { checkCellGroupingInfo } from '../common/helpers';\nimport { addDateToKey } from '../../utils';\n\nexport const sliceAppointmentByWeek: SliceAppointmentByWeekFn = (timeBounds, appointment, step) => {\n  const { left, right } = timeBounds;\n  const pieces: AppointmentMoment[] = [];\n  const { start, end, key, ...restFields } = appointment;\n  let apptStart = start;\n  let apptEnd = end;\n  if (apptStart.isBefore(left)) apptStart = left.clone();\n  if (apptEnd.isAfter(right)) apptEnd = right.clone();\n  let pieceFrom = apptStart.clone();\n  let pieceTo = apptStart.clone();\n  let i = 0;\n  while (pieceTo.isBefore(apptEnd)) {\n    const currentRightBound = left.clone().add(step * i, 'days').subtract(1, 'second');\n    if (currentRightBound.isAfter(apptStart)) {\n      pieceTo = apptStart.clone().add(step * i, 'days');\n      if (pieceTo.isAfter(currentRightBound)) {\n        pieceTo = currentRightBound.clone();\n      }\n      if (pieceTo.isAfter(apptEnd)) {\n        pieceTo = apptEnd.clone();\n      }\n      if (!pieceFrom.isSameOrAfter(pieceTo)) {\n        pieces.push({\n          start: pieceFrom,\n          end: pieceTo,\n          key: addDateToKey(key, pieceFrom),\n          ...restFields,\n        });\n        pieceFrom = pieceTo.clone().add(1, 'second');\n      }\n    }\n    i += 1;\n  }\n  return pieces;\n};\n\nexport const getMonthCellIndexByAppointmentData: GetMonthCellIndexByAppointmentDataFn = (\n  viewCellsData, viewMetaData, date, appointment, takePrev = false,\n) => {\n  const {\n    groupOrientation,\n    groupedByDate,\n    groupCount,\n  } = viewMetaData;\n\n  const startViewDate = moment(viewCellsData[0][0].startDate);\n  const currentDate = moment(date as SchedulerDateTime);\n  let dayNumber = currentDate.diff(startViewDate, 'days');\n  if (takePrev && currentDate.format() === currentDate.startOf('day').format()) {\n    dayNumber -= 1;\n  }\n  const weekNumber = Math.floor(dayNumber / DAYS_IN_WEEK);\n  const dayOfWeek = dayNumber % DAYS_IN_WEEK;\n\n  const columnIndex = groupOrientation === HORIZONTAL_GROUP_ORIENTATION\n    ? getMonthHorizontallyGroupedColumnIndex(\n      viewCellsData, appointment, weekNumber, dayOfWeek, groupCount, groupedByDate,\n    )\n    : dayOfWeek;\n  const rowIndex = groupOrientation === HORIZONTAL_GROUP_ORIENTATION\n    ? weekNumber\n    : getMonthVerticallyGroupedRowIndex(\n      viewCellsData, appointment, weekNumber, dayOfWeek, groupCount,\n    );\n\n  const totalCellIndex = rowIndex * viewCellsData[0].length + columnIndex;\n  return totalCellIndex;\n};\n\nexport const getMonthHorizontallyGroupedColumnIndex: PureComputed<\n  [ViewCell[][], AppointmentMoment, number, number, number, boolean], number\n> = (viewCellsData, appointment, weekNumber, dayOfWeek, groupCount, groupByDate) => {\n  let columnIndex = -1;\n  let currentColumnIndex = groupByDate ? dayOfWeek * groupCount : dayOfWeek;\n  const cellsInGroupRow = groupByDate ? 1 : DAYS_IN_WEEK;\n\n  while (columnIndex === -1) {\n    const isCorrectCell = checkCellGroupingInfo(\n      viewCellsData[weekNumber][currentColumnIndex], appointment,\n    );\n    if (isCorrectCell) {\n      columnIndex = currentColumnIndex;\n    }\n    currentColumnIndex += cellsInGroupRow;\n  }\n  return columnIndex;\n};\n\nexport const getMonthVerticallyGroupedRowIndex: PureComputed<\n  [ViewCell[][], AppointmentMoment, number, number, number], number\n> = (viewCellsData, appointment, weekNumber, dayOfWeek, groupCount) => {\n  const rowsInOneGroup = viewCellsData.length / groupCount;\n  let rowIndex = -1;\n  let currentRowIndex = weekNumber;\n  while (rowIndex === -1) {\n    const isCorrectCell = checkCellGroupingInfo(\n      viewCellsData[currentRowIndex][dayOfWeek], appointment,\n    );\n    if (isCorrectCell) {\n      rowIndex = currentRowIndex;\n    }\n    currentRowIndex += rowsInOneGroup;\n  }\n  return rowIndex;\n};\n","import { GetCellRectHorizontalFn, GetHorizontalRectByAppointmentDataFn } from '../../types';\nimport { getAllDayCellIndexByAppointmentData } from '../all-day-panel/helpers';\nimport { getMonthCellIndexByAppointmentData } from '../month-view/helpers';\n\nconst TOP_CELL_OFFSET = 0.32;\nconst CELL_BOUND_OFFSET_PX = 1;\n\nconst getCellRect: GetCellRectHorizontalFn = (\n  date, appointment, viewCellsData, viewMetaData, cellElementsMeta, takePrev, multiline,\n) => {\n  const cellIndex = multiline\n    ? getMonthCellIndexByAppointmentData(\n      viewCellsData, viewMetaData, date, appointment, takePrev,\n    ) : getAllDayCellIndexByAppointmentData(\n      viewCellsData, viewMetaData, date, appointment, takePrev,\n    );\n\n  const {\n    top,\n    left,\n    width,\n    height,\n  } = cellElementsMeta.getCellRects[cellIndex]();\n  const parentRect = cellElementsMeta.parentRect();\n  return {\n    top,\n    left,\n    width,\n    height,\n    parentRect,\n  };\n};\n\nexport const getHorizontalRectByAppointmentData: GetHorizontalRectByAppointmentDataFn = (\n  appointment,\n  viewMetaData,\n  {\n    multiline,\n    viewCellsData,\n    cellElementsMeta,\n  },\n) => {\n  const firstCellRect = getCellRect(\n    appointment.start.toDate(), appointment, viewCellsData,\n    viewMetaData, cellElementsMeta, false, multiline,\n  );\n  const lastCellRect = getCellRect(\n    appointment.end.toDate(), appointment, viewCellsData,\n    viewMetaData, cellElementsMeta, true, multiline,\n  );\n\n  const top = firstCellRect.top + (firstCellRect.height * TOP_CELL_OFFSET);\n  const height = firstCellRect.height - (firstCellRect.height * TOP_CELL_OFFSET);\n\n  return {\n    top: top - firstCellRect.parentRect.top,\n    left: (firstCellRect.left - firstCellRect.parentRect.left) + CELL_BOUND_OFFSET_PX,\n    width: ((lastCellRect.left - firstCellRect.left) + firstCellRect.width) - CELL_BOUND_OFFSET_PX,\n    height,\n    parentWidth: firstCellRect.parentRect.width,\n  };\n};\n","import moment from 'moment';\nimport {\n  MonthCellsDataComputedFn, MonthCellData,\n  CalculateMonthDateIntervalsFn, AppointmentMoment,\n} from '../../types';\nimport { filterByViewBoundaries } from '../../utils';\nimport { sliceAppointmentByWeek } from './helpers';\n\nconst DAY_COUNT = 7;\nconst MONTH_LENGTH = 31;\n\nexport const monthCellsData: MonthCellsDataComputedFn = (\n  currentDate,\n  firstDayOfWeek,\n  intervalCount = 1,\n  today,\n) => {\n  const targetDate = moment(currentDate as Date);\n  const currentMonths = [targetDate.month()];\n  while (currentMonths.length < intervalCount) {\n    currentMonths.push(targetDate.add(1, 'months').month());\n  }\n  const firstMonthDate = moment(currentDate as Date).date(1);\n  const firstMonthDay = firstMonthDate.day() - firstDayOfWeek;\n  const prevMonthDayCount = firstMonthDate.day(firstMonthDay).day() || DAY_COUNT;\n  const prevMonth = moment(currentDate as Date).subtract(1, 'months');\n  const prevMonthStartDay = prevMonth.daysInMonth() - (prevMonthDayCount - 1);\n  const from = moment()\n    .year(prevMonth.year())\n    .month(prevMonth.month())\n    .date(prevMonthStartDay)\n    .startOf('day');\n\n  const result: MonthCellData[][] = [];\n  while (result.length < (Math.trunc((MONTH_LENGTH * intervalCount) / DAY_COUNT) + 2)) {\n    const week: MonthCellData[] = [];\n    while (week.length < DAY_COUNT) {\n      week.push({\n        startDate: from.toDate(),\n        endDate: from.clone().add(1, 'day').toDate(),\n        otherMonth: currentMonths.findIndex(month => month === from.month()) === -1,\n        today: today ? moment(today as Date).isSame(from, 'date') : false,\n      });\n      from.add(1, 'day');\n    }\n    result.push(week);\n  }\n  return result;\n};\n\nexport const calculateMonthDateIntervals: CalculateMonthDateIntervalsFn = (\n  appointments, leftBound, rightBound,\n) => [\n  appointments\n    .map(({ start, end, ...restArgs }) => ({ start: moment(start), end: moment(end), ...restArgs }))\n    .reduce((acc, appointment) =>\n      [...acc, ...filterByViewBoundaries(appointment, leftBound, rightBound, [], false)],\n      [] as AppointmentMoment[],\n    )\n    .reduce((acc, appointment) => ([\n      ...acc,\n      ...sliceAppointmentByWeek(\n        { left: moment(leftBound as Date), right: moment(rightBound as Date) },\n        appointment,\n        DAY_COUNT,\n      ),\n    ]), [] as AppointmentMoment[]),\n];\n","import moment from 'moment';\nimport {\n  AppointmentMoment, CalculateAllDayDateIntervalsFn,\n} from '../../types';\nimport { allDayPredicate, sliceAppointmentsByBoundaries } from './helpers';\nimport { filterByViewBoundaries } from '../../utils';\n\nexport const calculateAllDayDateIntervals: CalculateAllDayDateIntervalsFn = (\n  appointments,\n  leftBound, rightBound,\n  excludedDays,\n) => [\n  appointments\n    .map(({ start, end, ...restArgs }) => ({ start: moment(start), end: moment(end), ...restArgs }))\n    .reduce((acc, appointment) =>\n      [...acc, ...filterByViewBoundaries(appointment, leftBound, rightBound, excludedDays, false)],\n      [] as AppointmentMoment[],\n    )\n    .filter(appointment => allDayPredicate(appointment))\n    .reduce((acc, appointment) => ([\n      ...acc,\n      ...sliceAppointmentsByBoundaries(appointment, leftBound, rightBound, excludedDays),\n    ]), [] as AppointmentMoment[]),\n];\n","import { PureComputed } from '@devexpress/dx-core';\nimport {\n  ValidResourceInstance, Group, ViewCell, ValidResource,\n  AppointmentMoment, Grouping, GroupOrientation, AppointmentKey,\n} from '../../types';\nimport { HORIZONTAL_GROUP_ORIENTATION } from '../../constants';\n\nexport const getGroupFromResourceInstance: PureComputed<\n  [ValidResourceInstance], Group\n> = resourceInstance => ({\n  id: resourceInstance.id,\n  fieldName: resourceInstance.fieldName,\n  text: resourceInstance.text,\n});\n\nexport const addGroupInfoToCells: PureComputed<\n  [Group, Group[][], ValidResource[],\n  ViewCell[], number, boolean, GroupOrientation], ViewCell[]\n> = (\n  currentGroup, groups, sortedResources, viewCellRow, index, endOfGroup, groupOrientation,\n) => viewCellRow.map((\n    viewCell: ViewCell, cellIndex: number,\n  ) => {\n  const groupedCell = addGroupInfoToCell(\n    currentGroup, groups, sortedResources, viewCell, index, endOfGroup, groupOrientation,\n  ) as ViewCell;\n  return cellIndex === viewCellRow.length - 1 && groupOrientation === HORIZONTAL_GROUP_ORIENTATION\n    ? { ...groupedCell, endOfGroup: true }\n    : groupedCell;\n});\n\nexport const addGroupInfoToCell: PureComputed<\n  [Group, Group[][], ValidResource[],\n  ViewCell, number, boolean, GroupOrientation], ViewCell\n> = (currentGroup, groups, sortedResources, viewCell, index, endOfGroup, groupOrientation) => {\n  let previousIndex = index;\n  const groupingInfo = groups.reduceRight((\n    acc: Group[], group: Group[], currentIndex: number,\n  ) => {\n    if (currentIndex === groups.length - 1) return acc;\n    const previousResourceLength = sortedResources[currentIndex + 1].instances.length;\n    const currentGroupingInstance = group[Math.floor(\n      previousIndex / previousResourceLength,\n    )];\n    previousIndex = currentIndex;\n    return [...acc, currentGroupingInstance];\n  }, [currentGroup]);\n  return { ...viewCell, groupingInfo, endOfGroup, groupOrientation };\n};\n\nconst getCurrentGroup: PureComputed<\n  [Group[][], ValidResource[], number, Group], Group[]\n> = (groups, resources, index, group) => {\n  let currentIndex = index;\n  return groups.reduceRight((groupAcc, groupsRow, rowIndex) => {\n    if (rowIndex === groups!.length - 1) {\n      return groupAcc;\n    }\n    currentIndex = Math.floor(currentIndex / resources[rowIndex + 1].instances.length);\n    const currentInstance = groupsRow[currentIndex];\n    return [\n      ...groupAcc,\n      currentInstance,\n    ];\n  }, [group]);\n};\n\nexport const groupAppointments: PureComputed<\n  [AppointmentMoment[], ValidResource[] | undefined,\n  Group[][] | undefined], AppointmentMoment[][]\n> = (appointments, resources, groups) => {\n  if (!resources || !groups) return [appointments.slice()];\n  const mainResource = resources.find(resource => resource.isMain);\n  return groups![groups!.length - 1].map((group, index) => {\n    const currentGroup = getCurrentGroup(groups, resources, index, group);\n\n    return appointments.reduce((acc, appointment) => {\n      const belongsToGroup = currentGroup.reduce((isBelonging, groupItem) => (\n        isBelonging && groupItem.id === appointment[groupItem.fieldName]\n      ), true);\n      if (!belongsToGroup) return acc;\n      const currentMainResourceId = currentGroup.find(\n        groupItem => groupItem.fieldName === mainResource!.fieldName,\n      )!.id;\n\n      const updatedAppointment = {\n        ...appointment,\n        dataItem: {\n          ...appointment.dataItem,\n          [mainResource!.fieldName]: rearrangeResourceIds(\n            mainResource!, appointment, currentMainResourceId,\n          ),\n        },\n        resources: appointment.resources && rearrangeResources(\n          mainResource!, appointment, currentMainResourceId,\n        ),\n      };\n      return [...acc, updatedAppointment];\n    }, [] as AppointmentMoment[]);\n  });\n};\n\nconst rearrangeResourceIds: PureComputed<\n  [ValidResource, AppointmentMoment, any], any[] | any\n> = (mainResource, appointment, mainResourceId) => {\n  if (!mainResource.allowMultiple) {\n    return mainResourceId;\n  }\n  return [\n    mainResourceId,\n    ...appointment.dataItem[mainResource!.fieldName].filter((id: any) => id !== mainResourceId),\n  ];\n};\n\nexport const rearrangeResources: PureComputed<\n  [ValidResource, AppointmentMoment, any], ValidResourceInstance[]\n> = (mainResource, appointment, currentResourceInstanceId) => {\n  if (!mainResource.allowMultiple) {\n    return appointment.resources;\n  }\n  const resources = appointment.resources.slice();\n  const firstMainResource = resources.findIndex((el: ValidResourceInstance) => el.isMain);\n  const currentResourceIndex = resources.findIndex(\n    (el: ValidResourceInstance) => el.isMain && el.id === currentResourceInstanceId,\n  );\n  [resources[firstMainResource], resources[currentResourceIndex]] =\n    [resources[currentResourceIndex], resources[firstMainResource]];\n  return resources;\n};\n\nexport const expandGroupedAppointment: PureComputed<\n  [AppointmentMoment, Grouping[], ValidResource[]], AppointmentMoment[]\n> = (appointment, grouping, resources) => {\n  if (!resources || !grouping) {\n    return [appointment];\n  }\n  return resources\n    .reduce((acc: AppointmentMoment[], resource: ValidResource) => {\n      const isGroupedByResource = grouping.find(\n        group => group.resourceName === resource.fieldName,\n      ) !== undefined;\n      if (!isGroupedByResource) return acc;\n      const resourceField = resource.fieldName;\n      if (!resource.allowMultiple) {\n        return acc.reduce((accumulatedAppointments, currentAppointment) => [\n          ...accumulatedAppointments,\n          { ...currentAppointment, [resourceField]: currentAppointment.dataItem[resourceField] },\n        ], [] as AppointmentMoment[]);\n      }\n      return acc.reduce((accumulatedAppointments, currentAppointment) => [\n        ...accumulatedAppointments,\n        ...currentAppointment.dataItem[resourceField].map(\n          (resourceValue: number | string) => ({\n            ...currentAppointment,\n            [resourceField]: resourceValue,\n            key: generateMultipleResourceKey(currentAppointment.key, resourceValue),\n          }),\n        ),\n      ], [] as AppointmentMoment[]);\n    }, [appointment] as AppointmentMoment[]);\n};\n\nconst generateMultipleResourceKey: PureComputed<\n  [AppointmentKey, number | string], AppointmentKey\n> = (previousKey, resourceValue) => `${previousKey}_${resourceValue}`;\n\nexport const getGroupingInfoFromGroups: PureComputed<\n  [Group[][], number], Group[]\n> = (groups, groupIndex) => {\n  let previousIndex = groupIndex;\n  return groups.reduceRight((acc, currentGroups, currentIndex) => {\n    if (currentIndex === groups.length - 1) return acc;\n    const previousResourceLength = groups[currentIndex + 1].length / currentGroups.length;\n    const currentGroupingInstance = currentGroups[Math.floor(\n      previousIndex / previousResourceLength,\n    )];\n    previousIndex = currentIndex;\n    return [...acc, currentGroupingInstance];\n  }, [getGroupsLastRow(groups)[groupIndex]]);\n};\n\nexport const getGroupsLastRow: PureComputed<\n  [Group[][]], Group[]\n> = groups => groups[groups.length - 1];\n","import { PureComputed } from '@devexpress/dx-core';\nimport {\n  Grouping, ValidResourceInstance, ViewCell, ValidResource,\n  Group, AppointmentMoment, ExpandGroupingPanelCellFn, GroupOrientation,\n  CellElementsMeta, SchedulerView,\n} from '../../types';\nimport {\n  getGroupFromResourceInstance, addGroupInfoToCells,\n  groupAppointments, expandGroupedAppointment, addGroupInfoToCell, getGroupsLastRow,\n} from './helpers';\nimport { sliceAppointmentsByDays } from '../all-day-panel/helpers';\nimport { HORIZONTAL_GROUP_ORIENTATION, VERTICAL_GROUP_ORIENTATION } from '../../constants';\nimport { containsDSTChange } from '../common/helpers';\n\nexport const filterResourcesByGrouping: PureComputed<\n  [Array<ValidResource>, Array<Grouping>], Array<ValidResource>\n> = (resources, grouping) => resources.filter(\n  resource => grouping.find(resourceId => resource.fieldName === resourceId.resourceName),\n);\n\nexport const sortFilteredResources: PureComputed<\n  [Array<ValidResource>, Array<Grouping>], Array<ValidResource>\n> = (resources, grouping) => grouping.map(({ resourceName }: Grouping) => (\n  resources.find(resource => resource.fieldName === resourceName) as ValidResource\n));\n\nexport const getGroupsFromResources: PureComputed<\n  [Array<ValidResource>], Array<Array<Group>>\n> = sortedAndFilteredResources => sortedAndFilteredResources.reduce((\n    acc: Array<Array<Group>>, resource: ValidResource, index: number,\n  ) => {\n  if (index === 0) {\n    return [resource.instances.map(instance => getGroupFromResourceInstance(instance))];\n  }\n\n  return [\n    ...acc,\n    acc[index - 1].reduce((currentResourceNames: Array<Group>) => [\n      ...currentResourceNames,\n      ...resource.instances.map(\n        (instance: ValidResourceInstance) => getGroupFromResourceInstance(instance),\n      ),\n    ], []),\n  ];\n}, []);\n\nexport const expandViewCellsDataWithGroups: PureComputed<\n  [ViewCell[][], Group[][], ValidResource[], boolean, GroupOrientation], ViewCell[][]\n> = (viewCellsData, groups, sortedResources, groupByDate, groupOrientation) => {\n  if (groups.length === 0) return viewCellsData;\n  if (groupByDate) {\n    return expandCellsWithGroupedByDateData(viewCellsData, groups, sortedResources);\n  }\n  if (groupOrientation === HORIZONTAL_GROUP_ORIENTATION) {\n    return expandHorizontallyGroupedCells(viewCellsData, groups, sortedResources);\n  }\n  return expandVerticallyGroupedCells(viewCellsData, groups, sortedResources);\n};\n\nconst expandCellsWithGroupedByDateData: ExpandGroupingPanelCellFn = (\n  viewCellsData, groups, sortedResources,\n) => viewCellsData.map(\n  (cellsRow: ViewCell[]) => cellsRow.reduce((acc: ViewCell[], viewCell: ViewCell) => {\n    const groupedCells = getGroupsLastRow(groups).map((\n      group: Group, index: number,\n    ) => addGroupInfoToCell(\n      group, groups, sortedResources, viewCell, index,\n      false, HORIZONTAL_GROUP_ORIENTATION,\n    ));\n    groupedCells[groupedCells.length - 1] = {\n      ...groupedCells[groupedCells.length - 1],\n      endOfGroup: true,\n    };\n    return [...acc, ...groupedCells] as ViewCell[];\n  }, [] as ViewCell[]),\n);\n\nconst expandHorizontallyGroupedCells: ExpandGroupingPanelCellFn = (\n  viewCellsData, groups, sortedResources,\n) => getGroupsLastRow(groups).reduce((\n  acc: ViewCell[][], group: Group, index: number,\n) => {\n  if (index === 0) {\n    return viewCellsData.map((viewCellsRow: ViewCell[]) =>\n      addGroupInfoToCells(\n        group, groups, sortedResources, viewCellsRow, index,\n        false, HORIZONTAL_GROUP_ORIENTATION,\n      ) as ViewCell[],\n    );\n  }\n  return acc.map((item: ViewCell[], id: number) => [\n    ...item,\n    ...addGroupInfoToCells(\n      group, groups, sortedResources, viewCellsData[id], index,\n      false, HORIZONTAL_GROUP_ORIENTATION,\n    ),\n  ]);\n}, [[]] as ViewCell[][]);\n\nconst expandVerticallyGroupedCells: ExpandGroupingPanelCellFn = (\n  viewCellsData, groups, sortedResources,\n) => getGroupsLastRow(groups).reduce((\n  acc: ViewCell[][], group: Group, index: number,\n) => {\n  if (index === 0) {\n    return viewCellsData.map((\n      viewCellsRow: ViewCell[], viewRowIndex: number,\n    ) => addGroupInfoToCells(\n        group, groups, sortedResources, viewCellsRow,\n        index, viewRowIndex === viewCellsData.length - 1, VERTICAL_GROUP_ORIENTATION,\n      ) as ViewCell[]);\n  }\n  return [\n    ...acc,\n    ...viewCellsData.map((viewCellsRow: ViewCell[], viewRowIndex: number) =>\n      addGroupInfoToCells(\n        group, groups, sortedResources, viewCellsRow,\n        index, viewRowIndex === viewCellsData.length - 1, VERTICAL_GROUP_ORIENTATION,\n      ) as ViewCell[],\n    ),\n  ];\n}, [[]] as ViewCell[][]);\n\nexport const updateGroupingWithMainResource: PureComputed<\n  [Grouping[] | undefined, ValidResource[]], Grouping[]\n> = (grouping, resources) => grouping\n  || [{ resourceName: resources.find(resource => resource.isMain)!.fieldName }];\n\nexport const expandGroups: PureComputed<\n  [AppointmentMoment[][], Grouping[], ValidResource[],\n  Group[][], number[], boolean], AppointmentMoment[][]\n> = (appointments, grouping, resources, groups, excludedDays, sliceByDay = false) => {\n  const slicedAppointments = sliceByDay ?\n    appointments[0].reduce((acc: AppointmentMoment[], appointment: AppointmentMoment) => ([\n      ...acc,\n      ...sliceAppointmentsByDays(appointment, excludedDays),\n    ]), [] as AppointmentMoment[]) : appointments[0];\n\n  const expandedAppointments = (slicedAppointments as AppointmentMoment[])\n    .reduce((acc: AppointmentMoment[], appointment: AppointmentMoment) => [\n      ...acc,\n      ...expandGroupedAppointment(appointment, grouping, resources),\n    ], [] as AppointmentMoment[]);\n  return groupAppointments(expandedAppointments, resources, groups);\n};\n\nexport const updateTimeTableCellElementsMeta: PureComputed<\n  [CellElementsMeta, (viewName: string) => GroupOrientation, Group[][],\n  boolean, ViewCell[][], SchedulerView], CellElementsMeta\n> = (\n  timeTableElementsMeta, groupOrientation, groups, allDayPanelExists, viewCellsData, currentView,\n) => {\n  if (checkCellElementsMeta(\n    timeTableElementsMeta, groupOrientation, currentView, allDayPanelExists,\n  )) {\n    return timeTableElementsMeta;\n  }\n\n  const {\n    groupCount, timeTableWidth, groupSize, validGetCellRects,\n  } = initializeCellElementsData(timeTableElementsMeta, viewCellsData, groups);\n  let allDayPanelsLeft = groupCount;\n\n  while (allDayPanelsLeft > 0) {\n    allDayPanelsLeft -= 1;\n    validGetCellRects.splice(allDayPanelsLeft * (timeTableWidth + groupSize), timeTableWidth);\n  }\n\n  return {\n    parentRect: timeTableElementsMeta.parentRect,\n    getCellRects: validGetCellRects,\n  };\n};\n\nexport const updateAllDayCellElementsMeta: PureComputed<\n  [CellElementsMeta, CellElementsMeta, (viewName: string) => GroupOrientation, Group[][],\n  boolean, ViewCell[][], SchedulerView], CellElementsMeta\n> = (\n  allDayElementsMeta, timeTableElementsMeta, groupOrientation, groups,\n  allDayPanelExists, viewCellsData, currentView,\n) => {\n  if (checkCellElementsMeta(\n    timeTableElementsMeta, groupOrientation, currentView, allDayPanelExists,\n  )) {\n    return allDayElementsMeta;\n  }\n\n  const {\n    groupCount, timeTableWidth, groupSize, validGetCellRects,\n  } = initializeCellElementsData(timeTableElementsMeta, viewCellsData, groups);\n  let allDayPanelsLeft = groupCount;\n\n  while (allDayPanelsLeft > 0) {\n    allDayPanelsLeft -= 1;\n    validGetCellRects.splice(\n      groupSize * allDayPanelsLeft + timeTableWidth * (allDayPanelsLeft + 1), groupSize,\n    );\n  }\n\n  return {\n    parentRect: timeTableElementsMeta.parentRect,\n    getCellRects: validGetCellRects,\n  };\n};\n\nconst checkCellElementsMeta: PureComputed<\n  [CellElementsMeta, (viewName: string) => GroupOrientation, SchedulerView, boolean], boolean\n> = (\n  cellElementsMeta, groupOrientation, currentView, allDayPanelExists,\n) => groupOrientation(currentView.name) === HORIZONTAL_GROUP_ORIENTATION\n  || !allDayPanelExists || !cellElementsMeta.getCellRects;\n\nconst initializeCellElementsData: PureComputed<\n  [CellElementsMeta, ViewCell[][], Group[][]], any\n> = (cellElementsMeta, viewCellsData, groups) => {\n  const timeTableWidth = viewCellsData[0].length;\n  const groupCount = getGroupsLastRow(groups).length;\n  const groupHeight = viewCellsData.length / groupCount;\n  return {\n    groupCount,\n    timeTableWidth,\n    groupSize: timeTableWidth * groupHeight,\n    validGetCellRects: cellElementsMeta.getCellRects.slice(),\n  };\n};\n\nexport const updateTimeCellsData: PureComputed<\n  [ViewCell[][], ViewCell[][], Group[][], ValidResource[], GroupOrientation], ViewCell[][]\n> = (viewCellsData, timeCellsData, groups, sortedResources, groupOrientation) => {\n  const { startDate: firstViewDate } = viewCellsData[0][0];\n  if (!containsDSTChange(firstViewDate)) {\n    return viewCellsData;\n  }\n\n  if (groupOrientation !== VERTICAL_GROUP_ORIENTATION) {\n    return timeCellsData;\n  }\n\n  return expandVerticallyGroupedCells(timeCellsData, groups, sortedResources);\n};\n","import {\n  AllDayRects, VerticalRects, HorizontalRects,\n} from '../../types';\nimport {\n  VERTICAL_TYPE, HORIZONTAL_TYPE,\n} from '../../constants';\nimport { calculateRectByDateAndGroupIntervals } from '../appointments/helpers';\nimport { calculateWeekDateIntervals } from '../week-view/computeds';\nimport { getVerticalRectByAppointmentData } from '../vertical-rect/helpers';\nimport { getHorizontalRectByAppointmentData } from '../horizontal-rect/helpers';\nimport { calculateMonthDateIntervals } from '../month-view/computeds';\nimport { calculateAllDayDateIntervals } from '../all-day-panel/computeds';\nimport { expandGroups } from '../integrated-grouping/computeds';\nimport { getGroupsLastRow } from '../integrated-grouping/helpers';\n\nexport const allDayRects: AllDayRects = (\n  appointments, startViewDate, endViewDate,\n  excludedDays, viewCellsData, cellElementsMeta,\n  grouping, resources, groups, groupOrientation, sliceAppointments,\n) => {\n  const intervals = calculateAllDayDateIntervals(\n    appointments, startViewDate, endViewDate, excludedDays,\n  );\n  const groupedIntervals = expandGroups(\n    intervals, grouping, resources, groups, excludedDays, sliceAppointments,\n  );\n\n  return calculateRectByDateAndGroupIntervals(\n    {\n      growDirection: HORIZONTAL_TYPE,\n      multiline: false,\n    },\n    groupedIntervals,\n    getHorizontalRectByAppointmentData,\n    {\n      startViewDate,\n      endViewDate,\n      viewCellsData,\n      cellElementsMeta,\n      excludedDays,\n    },\n    {\n      groupOrientation,\n      groupedByDate: sliceAppointments,\n      groupCount: groups ? getGroupsLastRow(groups).length : 1,\n    },\n  );\n};\n\nexport const verticalTimeTableRects: VerticalRects = (\n  appointments, startViewDate, endViewDate, excludedDays, viewCellsData,\n  cellDuration, cellElementsMeta, grouping, resources, groups,  groupOrientation, groupByDate,\n) => {\n  const intervals = calculateWeekDateIntervals(\n    appointments, startViewDate, endViewDate, excludedDays, cellDuration,\n  );\n  const groupedIntervals = expandGroups(\n    intervals, grouping, resources, groups, excludedDays, false,\n  );\n\n  return calculateRectByDateAndGroupIntervals(\n    {\n      growDirection: VERTICAL_TYPE,\n      multiline: false,\n    },\n    groupedIntervals,\n    getVerticalRectByAppointmentData,\n    {\n      startViewDate,\n      endViewDate,\n      viewCellsData,\n      cellDuration,\n      cellElementsMeta,\n    },\n    {\n      groupOrientation,\n      groupedByDate: groupByDate,\n      groupCount: groups ? getGroupsLastRow(groups).length : 1,\n    },\n  );\n};\n\nexport const horizontalTimeTableRects: HorizontalRects = (\n  appointments, startViewDate, endViewDate, viewCellsData,\n  cellElementsMeta, grouping, resources, groups, groupOrientation, sliceAppointments,\n) => {\n  const intervals = calculateMonthDateIntervals(\n    appointments, startViewDate, endViewDate,\n  );\n  const groupedIntervals = expandGroups(\n    intervals, grouping, resources, groups, [], sliceAppointments,\n  );\n\n  return calculateRectByDateAndGroupIntervals(\n    {\n      growDirection: HORIZONTAL_TYPE,\n      multiline: true,\n    },\n    groupedIntervals,\n    getHorizontalRectByAppointmentData,\n    {\n      startViewDate,\n      endViewDate,\n      viewCellsData,\n      cellElementsMeta,\n    },\n    {\n      groupOrientation,\n      groupedByDate: sliceAppointments,\n      groupCount: groups ? getGroupsLastRow(groups).length : 1,\n    },\n  );\n};\n","import { DateTimeFormatInstanceFn } from '../../types';\n\nexport const dateTimeFormatInstance: DateTimeFormatInstanceFn = (\n  locale, formatOptions,\n) => new Intl.DateTimeFormat(locale, formatOptions);\n","import { PureComputed } from '@devexpress/dx-core';\nimport { AppointmentModel, Appointment, FormatDateTimeGetterFn, FormatterFn } from '../../types';\nimport { convertToMoment } from '../common/helpers';\nimport { dateTimeFormatInstance } from './helpers';\n\nexport const appointments: PureComputed<\n  [AppointmentModel[]], Appointment[]\n> = data => data.map((appointment, index) => ({\n  dataItem: appointment,\n  start: appointment.startDate,\n  ...appointment.endDate !== undefined ? {\n    end: appointment.endDate,\n  } : {\n    end: appointment.startDate,\n    dataItem: { ...appointment, endDate: appointment.startDate },\n  },\n  ...appointment.allDay !== undefined && {\n    allDay: appointment.allDay,\n  },\n  ...appointment.rRule !== undefined && {\n    rRule: appointment.rRule,\n  },\n  ...appointment.exDate !== undefined && {\n    exDate: appointment.exDate,\n  },\n  key: appointment.id || index,\n}));\n\nexport const formatDateTimeGetter: FormatDateTimeGetterFn = (locale) => {\n  const cache = new Map<Intl.DateTimeFormatOptions, Intl.DateTimeFormat>(); // any -> type\n\n  const formatter: FormatterFn = (nextDate, nextOptions) => {\n    if (nextDate === undefined) return '';\n    const date = convertToMoment(nextDate).toDate();\n    let formatInstance = cache.get(nextOptions);\n\n    if (!formatInstance) {\n      formatInstance = dateTimeFormatInstance(locale, nextOptions);\n      cache.set(nextOptions, formatInstance);\n    }\n\n    return formatInstance.format(date);\n  };\n  return formatter;\n};\n","import { PureComputed } from '@devexpress/dx-core';\nimport { Group, HorizontalGroupingCellData, VerticalGroupingCellData } from '../../types';\nimport { getGroupsLastRow } from '../integrated-grouping/helpers';\n\nexport const getCellKey: PureComputed<\n  [Group[][], number, number], string\n> = (groups, groupIndex, rowNumber) => {\n  let currentIndex = groupIndex;\n  return groups.reduceRight((acc: string, groupRow: Group[], rowIndex: number) => {\n    if (rowNumber < rowIndex) return acc;\n    const currentKey = groupRow[currentIndex].id;\n    if (rowIndex > 0) {\n      const currentRowLength = groups[rowIndex].length / groups[rowIndex - 1].length;\n      currentIndex = Math.floor(currentIndex / currentRowLength);\n    }\n    return acc + currentKey;\n  }, '' as string);\n};\n\nexport const getRowFromGroups: PureComputed<\n  [number, Group[], any, Group[][], number], HorizontalGroupingCellData[]\n> = (width, groupRow, cellStyle, groups, rowIndex) => {\n  let row = [] as any[];\n  const currentRowLength = groupRow.length;\n  const standardWidth = width / getGroupsLastRow(groups).length;\n  const colSpan = getGroupsLastRow(groups).length / currentRowLength;\n  for (let i = 0; i < standardWidth; i += 1) {\n    row = [...row, ...groupRow.reduce((acc, group, index) => [\n      ...acc,\n      {\n        group,\n        colSpan,\n        key: getCellKey(groups, index, rowIndex) + i,\n        left: cellStyle.left,\n        endOfGroup: index === currentRowLength - 1,\n      },\n    ], [] as any[])];\n  }\n  return row;\n};\n\nexport const getVerticalRowFromGroups: PureComputed<\n  [Group[][], number, number, number, boolean, number], VerticalGroupingCellData[]\n> = (\n  groups, groupIndex, groupingPanelRowSpan,\n  timeTableCellHeight, addAllDayHeight, allDayCellHeight,\n) => groups.reduce((\n  acc, groupColumn, columnIndex,\n) => {\n  const groupSpan = getGroupsLastRow(groups).length / groupColumn.length;\n  const cellIndex = groupIndex / groupSpan;\n  const baseHeight = (groupingPanelRowSpan * groupSpan * timeTableCellHeight)\n    / getGroupsLastRow(groups).length;\n  const allDayHeight = groupSpan * allDayCellHeight;\n\n  return groupIndex % groupSpan !== 0 ? acc : [\n    ...acc,\n    {\n      group: groupColumn[cellIndex],\n      rowSpan: groupSpan,\n      height: addAllDayHeight ? baseHeight + allDayHeight : baseHeight,\n      key: getCellKey(groups, cellIndex, columnIndex),\n    },\n  ];\n}, [] as VerticalGroupingCellData[]);\n","import { PureComputed } from '@devexpress/dx-core';\nimport { HORIZONTAL_GROUP_ORIENTATION } from '../../constants';\nimport { ViewCell, Group, GroupOrientation, TimeScaleLabelData, AllDayCell } from '../../types';\nimport { getCellKey } from '../grouping-panel/utils';\nimport { getGroupsLastRow } from '../integrated-grouping/helpers';\n\nconst getLabelsForSingleGroup: PureComputed<\n  [Group[][], ViewCell[][], number, number], TimeScaleLabelData[]\n> = (groups, cellsData, groupIndex, groupHeight) => {\n  const currentGroupIndex = groupIndex * groupHeight;\n  const nextGroupIndex = currentGroupIndex + groupHeight;\n\n  return cellsData.slice(currentGroupIndex, nextGroupIndex - 1).reduce((\n    acc: TimeScaleLabelData[], days: ViewCell[],\n  ) => (([\n    ...acc,\n    {\n      startDate: days[0].startDate,\n      endDate: days[0].endDate,\n      key: days[0].endDate + getCellKey(groups, groupIndex, groups.length - 1),\n      groupingInfo: days[0].groupingInfo,\n    },\n  ])), [] as TimeScaleLabelData[]);\n};\n\nexport const getLabelsForAllGroups: PureComputed<\n  [ViewCell[][], Group[][], GroupOrientation], TimeScaleLabelData[][]\n> = (cellsData, groups, groupOrientation) => {\n  if (groupOrientation === HORIZONTAL_GROUP_ORIENTATION) {\n    return [cellsData.map(cellsRow => ({\n      startDate: cellsRow[0].startDate,\n      endDate: cellsRow[0].endDate,\n      groupingInfo: cellsRow[0].groupingInfo,\n      key: cellsRow[0].endDate,\n    }))];\n  }\n\n  const groupCount = getGroupsLastRow(groups).length;\n  const singleGroupHeight = cellsData.length / groupCount;\n\n  return getGroupsLastRow(groups).reduce((\n    acc: TimeScaleLabelData[][], group: Group, groupIndex: number,\n  ) => [\n    ...acc,\n    getLabelsForSingleGroup(\n      groups, cellsData, groupIndex, singleGroupHeight,\n    ) as TimeScaleLabelData[],\n  ], [] as TimeScaleLabelData[][]);\n};\n\nexport const prepareVerticalViewCellsData: PureComputed<\n  [ViewCell[][], AllDayCell[][]], ViewCell[][][]\n> = (cellsData, allDayCellsData) => {\n  const groupCount = allDayCellsData?.length || 1;\n  const validCellsData = [] as ViewCell[][][];\n  const groupHeight = cellsData.length / groupCount;\n  for (let i = 0; i < groupCount; i += 1) {\n    validCellsData.push(cellsData.slice(i * groupHeight, (i + 1) * groupHeight));\n  }\n  return validCellsData;\n};\n","import moment from 'moment';\nimport { PureReducer } from '@devexpress/dx-core';\nimport { ChangeCurrentDatePayload } from '../../types';\n\nexport const changeCurrentDate: PureReducer<Date, ChangeCurrentDatePayload> = (\n  currentDate, {\n  nextDate, step, amount, direction,\n}) => (\n  nextDate\n  || moment(currentDate as Date)[direction === 'back' ? 'subtract' : 'add'](amount, step)\n    .toDate()\n  || moment().subtract(amount, step)\n);\n\nexport const setCurrentViewName: PureReducer<\n  string, string, string\n> = (currentViewName, nextViewName) => nextViewName;\n","import { PureReducer } from '@devexpress/dx-core';\nimport { AppointmentMeta } from '../../types';\n\nexport const setAppointmentMeta: PureReducer<AppointmentMeta, AppointmentMeta> = (\n  prevAppointmentMeta,\n  { target, data },\n) => ({ target, data });\n","export const OPEN_COMMAND_BUTTON = 'open';\nexport const CLOSE_COMMAND_BUTTON = 'close';\nexport const DELETE_COMMAND_BUTTON = 'delete';\nexport const CANCEL_COMMAND_BUTTON = 'cancel';\nexport const COMMIT_COMMAND_BUTTON = 'commit';\n","import { PureReducer } from '@devexpress/dx-core';\nimport { AppointmentModel, AppointmentDataPayload } from '../../types';\n\nexport const setAppointmentData: PureReducer<\n  AppointmentModel, AppointmentDataPayload\n> = (prevAppointmentData, { appointmentData }) => appointmentData;\n","import {\n  LONG_WEEK_DAY_OPTIONS, DAY_LONG_MONTH_OPTIONS,\n  LONG_MONTH_OPTIONS,\n} from '@devexpress/dx-scheduler-core';\nimport { PureComputed } from '@devexpress/dx-core';\nimport {\n  SelectOption, OptionsFormatterFn, DateFormatterFn, RecurrenceFrequency,\n} from '../../types';\nimport {\n  MONTHS_DATES, REPEAT_TYPES_ARRAY, WEEK_NUMBER_LABELS, DAYS_IN_WEEK, RRULE_REPEAT_TYPES,\n  BASIC_YEALY_COUNT, BASIC_MONTHLY_COUNT, BASIC_WEEKLY_COUNT, BASIC_DAILY_COUNT,\n} from './constants';\nimport { getDaysOfWeekDates, getDaysOfWeekArray } from './helpers';\n\nexport const getWeekNumberLabels: OptionsFormatterFn = getMessage =>\n  WEEK_NUMBER_LABELS.map((weekNumberLabel, index) => ({\n    text: getMessage(weekNumberLabel),\n    id: index,\n  }));\n\nexport const getDaysOfWeek: PureComputed<\n  [(date: Date, formatOptions: object) => string, number], Array<SelectOption>\n> = (formatDate, firstDayOfWeek) => {\n  const daysOfWeekArray = getDaysOfWeekArray(firstDayOfWeek);\n  const daysOfWeekDates = getDaysOfWeekDates(firstDayOfWeek);\n  return daysOfWeekDates.map(\n    (day, index) => ({\n      text: getDayOfWeek(day, formatDate),\n      id: index + 1 < DAYS_IN_WEEK ? daysOfWeekArray[index + 1] : daysOfWeekArray[0],\n    }),\n  );\n};\n\nexport const getMonths: DateFormatterFn = formatDate => MONTHS_DATES.map((month, index) => ({\n  text: getMonth(month, formatDate),\n  id: getMonthId(index),\n}));\n\nexport const getMonthsWithOf: PureComputed<\n  [(messageKey: string) => string, (date: Date, formatOptions: object) => string],\n    Array<SelectOption>\n> = (getMessage, formatDate) => MONTHS_DATES.map((month, index) => ({\n  text: getMonthWithOf(month, getMessage, formatDate),\n  id: getMonthId(index),\n}));\n\nconst getMonthWithOf = (\n  date: Date,\n  getMessage: (messageKey: string) => string,\n  formatDate: (date: Date, formatOptions: object) => string,\n) => getMessage('ofLabel')\n  + formatDate(date, DAY_LONG_MONTH_OPTIONS).replace(/[\\d.,]/g, '').toString();\n\nconst getMonth = (\n  date: Date,\n  formatDate: (date: Date, formatOptions: object) => string,\n) => formatDate(date, LONG_MONTH_OPTIONS);\n\nconst getDayOfWeek = (\n  date: Date,\n  formatDate: (date: Date, formatOptions: object) => string,\n) => formatDate(date, LONG_WEEK_DAY_OPTIONS);\n\nconst getMonthId: PureComputed<\n  [number], number\n> = index => index + 1;\n\nexport const getAvailableRecurrenceOptions: OptionsFormatterFn = getMessage =>\n  REPEAT_TYPES_ARRAY.map(type => ({\n    text: getMessage(type),\n    id: type,\n  }));\n\nexport const getCountDependingOnRecurrenceType = (frequency: RecurrenceFrequency) => {\n  let count;\n  switch (frequency) {\n    case RRULE_REPEAT_TYPES.YEARLY:\n      count = BASIC_YEALY_COUNT;\n      break;\n    case RRULE_REPEAT_TYPES.MONTHLY:\n      count = BASIC_MONTHLY_COUNT;\n      break;\n    case RRULE_REPEAT_TYPES.WEEKLY:\n      count = BASIC_WEEKLY_COUNT;\n      break;\n    case RRULE_REPEAT_TYPES.DAILY:\n      count = BASIC_DAILY_COUNT;\n      break;\n  }\n  return count;\n};\n\nexport const checkIsNaturalNumber: PureComputed<\n  [number], boolean\n> = number => number > 0 && number <= Number.MAX_SAFE_INTEGER;\n","import moment from 'moment';\nimport { PureComputed } from '@devexpress/dx-core';\nimport { RRule, Options, Weekday } from 'rrule';\nimport {\n  Action,\n  StartDate,\n  EndDate,\n  RadioGroupDisplayData,\n  ValidResource,\n} from '../../types';\nimport {\n  DEFAULT_RULE_OBJECT, RRULE_REPEAT_TYPES, REPEAT_TYPES, LAST_WEEK,\n  DAYS_OF_WEEK_ARRAY, DAYS_IN_WEEK, DAYS_OF_WEEK_DATES, RRULE_DAYS_OF_WEEK,\n} from './constants';\nimport { getCountDependingOnRecurrenceType } from './utils';\n\nexport const callActionIfExists: PureComputed<[Action, object], void> = (action, payload) => {\n  if (action) {\n    action(payload);\n  }\n};\n\nexport const isAllDayCell: PureComputed<\n  [StartDate, EndDate], boolean\n> = (\n  startDate, endDate,\n) => moment(endDate as EndDate).diff(moment(startDate as StartDate), 'days') >= 1;\n\nexport const changeRecurrenceFrequency: PureComputed<\n  [string, number, Date], string\n> = (\n  rule, freq, startDate,\n) => {\n  if (!rule) {\n    if (freq === RRULE_REPEAT_TYPES.MONTHLY) {\n      return (new RRule({\n        ...DEFAULT_RULE_OBJECT,\n        freq,\n        bymonthday: [startDate.getDate()],\n        count: getCountDependingOnRecurrenceType(freq),\n      })).toString();\n    }\n    if (freq === RRULE_REPEAT_TYPES.YEARLY) {\n      return (new RRule({\n        ...DEFAULT_RULE_OBJECT,\n        freq,\n        bymonthday: [startDate.getDate()],\n        bymonth: startDate.getMonth() + 1,\n        count: getCountDependingOnRecurrenceType(freq),\n      })).toString();\n    }\n    return (new RRule({\n      ...DEFAULT_RULE_OBJECT, freq, count: getCountDependingOnRecurrenceType(freq),\n    })).toString();\n  }\n\n  const options = RRule.parseString(rule);\n  if (options.freq === freq) return rule;\n\n  options.freq = freq;\n  options.count = getCountDependingOnRecurrenceType(freq);\n  if (freq === RRULE_REPEAT_TYPES.MONTHLY || freq === RRULE_REPEAT_TYPES.YEARLY) {\n    options.bymonthday = startDate.getDate();\n  }\n  if (freq === RRULE_REPEAT_TYPES.YEARLY) {\n    options.bymonth = startDate.getMonth() + 1;\n  }\n  if (freq === RRULE_REPEAT_TYPES.DAILY || freq === RRULE_REPEAT_TYPES.WEEKLY) {\n    options.bymonthday = undefined;\n  }\n  options.byweekday = undefined;\n  const nextRule = new RRule(options);\n  return nextRule.toString();\n};\n\nexport const getRecurrenceOptions: PureComputed<\n  [string | undefined], Partial<Options> | null\n> = rule => !rule ? null : RRule.parseString(rule);\n\nexport const changeRecurrenceOptions = (options: Partial<Options>) => {\n  return options ? (new RRule({ ...options })).toString() : undefined;\n};\n\nexport const handleStartDateChange = (nextStartDay: number, options: Partial<Options>) => {\n  if (nextStartDay <= 31) {\n    const nextOptions = { ...options, bymonthday: nextStartDay };\n    return changeRecurrenceOptions(nextOptions);\n  }\n  return changeRecurrenceOptions(options);\n};\n\nexport const handleToDayOfWeekChange = (\n  weekNumber: number, dayOfWeek: number, options: Partial<Options>,\n) => {\n  const validDayOfWeek = dayOfWeek > 0 ? dayOfWeek - 1 : 6;\n  const validWeekNumber = weekNumber === 4 ? -1 : weekNumber + 1;\n  const rruleDayOfWeek = RRULE_DAYS_OF_WEEK[validDayOfWeek];\n\n  const nextOptions = {\n    ...options,\n    byweekday: [rruleDayOfWeek.nth(validWeekNumber)],\n    bymonthday: undefined,\n  };\n\n  return changeRecurrenceOptions(nextOptions);\n};\n\nexport const getRRuleFrequency: PureComputed<\n  [string], number\n> = repeatType => RRULE_REPEAT_TYPES[repeatType.toUpperCase()];\n\nexport const getFrequencyString: PureComputed<\n  [number], string\n> = (rRuleFrequency) => {\n  if (rRuleFrequency === RRULE_REPEAT_TYPES.DAILY) return REPEAT_TYPES.DAILY;\n  if (rRuleFrequency === RRULE_REPEAT_TYPES.WEEKLY) return REPEAT_TYPES.WEEKLY;\n  if (rRuleFrequency === RRULE_REPEAT_TYPES.MONTHLY) return REPEAT_TYPES.MONTHLY;\n  if (rRuleFrequency === RRULE_REPEAT_TYPES.YEARLY) return REPEAT_TYPES.YEARLY;\n  return REPEAT_TYPES.NEVER;\n};\n\nexport const getRadioGroupDisplayData: PureComputed<\n  [Partial<Options>, number, number, number, string, string], RadioGroupDisplayData\n> = (\n  recurrenceOptions, stateDayOfWeek, stateWeekNumber, stateDayNumber, firstOption, secondOption,\n) => {\n  if (recurrenceOptions.bymonthday && !Array.isArray(recurrenceOptions.bymonthday)) {\n    return {\n      dayNumberTextField: (recurrenceOptions.bymonthday as number),\n      weekNumber: stateWeekNumber,\n      dayOfWeek: stateDayOfWeek,\n      radioGroupValue: firstOption,\n    };\n  }\n  if (!recurrenceOptions.byweekday) {\n    return {\n      dayOfWeek: stateDayOfWeek,\n      weekNumber: stateWeekNumber,\n      radioGroupValue: secondOption,\n      dayNumberTextField: stateDayNumber,\n    };\n  }\n  const dayOfWeek = recurrenceOptions.byweekday[0].weekday < 6\n    ? recurrenceOptions.byweekday[0].weekday + 1 : 0;\n  const weekNumber = recurrenceOptions.byweekday[0].n === -1\n    ? LAST_WEEK\n    : recurrenceOptions.byweekday[0].n - 1;\n\n  return {\n    dayOfWeek,\n    weekNumber,\n    radioGroupValue: secondOption,\n    dayNumberTextField: stateDayNumber,\n  };\n};\n\nexport const handleChangeFrequency: PureComputed<\n  [string, string, Date, Action], void\n> = (repeatType, rRule, startDate, action) => {\n  const rruleRepeatType = getRRuleFrequency(repeatType);\n  let nextRRule;\n  if (rruleRepeatType !== undefined) {\n    nextRRule = changeRecurrenceFrequency(\n      rRule,\n      rruleRepeatType,\n      startDate,\n    );\n  }\n  action({ rRule: nextRRule });\n};\n\nexport const handleWeekDaysChange: PureComputed<\n[Partial<Options>, number], void\n> = (options, currentWeekDay) => {\n  const byWeekDay = options.byweekday || [];\n  const index = (byWeekDay as Weekday[]).findIndex(({ weekday }) => weekday === currentWeekDay);\n\n  const isAdded = index === -1;\n\n  if (isAdded) {\n    (byWeekDay as Weekday[]).push(RRULE_DAYS_OF_WEEK[currentWeekDay]);\n  } else if (index > -1) {\n    (byWeekDay as Weekday[]).splice(index, 1);\n  }\n  if (byWeekDay === 0) return { ...options, byweekday: undefined };\n  return { ...options, byweekday: byWeekDay };\n};\n\nexport const getDaysOfWeekArray: PureComputed<[number], Array<number>> = (firstDayOfWeek) => {\n  const firstPart = DAYS_OF_WEEK_ARRAY.filter(\n    dayOfWeek => dayOfWeek >= firstDayOfWeek - 1 && dayOfWeek < DAYS_IN_WEEK - 1,\n  );\n  const secondPart = DAYS_OF_WEEK_ARRAY.filter(\n    dayOfWeek => dayOfWeek < firstDayOfWeek - 1 || dayOfWeek >= DAYS_IN_WEEK - 1,\n  );\n  return firstDayOfWeek !== 0 ? [...firstPart, ...secondPart] : [...secondPart, ...firstPart];\n};\n\nexport const getDaysOfWeekDates: PureComputed<[number], Array<Date>> = (firstDayOfWeek) => {\n  const firstPart = DAYS_OF_WEEK_DATES.slice(firstDayOfWeek, DAYS_OF_WEEK_DATES.length);\n  const secondPart = DAYS_OF_WEEK_DATES.slice(0, firstDayOfWeek);\n  return [...firstPart, ...secondPart];\n};\n\nexport const checkMultipleResourceFields: PureComputed<\n  [object, ValidResource[]], object\n> = (resourceFields, resources) => resources.reduce((acc, resource) => {\n  if (!resource.allowMultiple) {\n    return acc;\n  }\n\n  const fieldName = resource.fieldName;\n  const field = resourceFields[fieldName];\n  return {\n    ...acc,\n    [fieldName]: Array.isArray(field) ? field : [field],\n  };\n}, resourceFields);\n","import { PureReducer } from '@devexpress/dx-core';\nimport {\n  AddedAppointmentDataPayload, AppointmentModel, Changes, EditAppointmentPayload,\n} from '../../types';\n\nexport const addAppointment: PureReducer<\n  AppointmentModel, AddedAppointmentDataPayload, AppointmentModel | {}\n> = (\n  addedAppointmentData, { appointmentData } = { appointmentData:  {} },\n) => appointmentData;\n\nexport const cancelAddedAppointment = () => ({});\n\nexport const startEditAppointment: PureReducer<\n  Partial<AppointmentModel>, EditAppointmentPayload\n> = (prevEditingAppointment, appointmentData) => appointmentData;\n\nexport const stopEditAppointment = () => null;\n\nexport const changeAppointment: PureReducer<\nAppointmentModel, Changes\n> = (\n  appointment, { change },\n) => ({ ...appointment, ...change });\n\nexport const cancelChanges = () => ({});\n","import { PureComputed } from '@devexpress/dx-core';\nimport { AppointmentId, AppointmentChanges, Changes } from '../../types';\n\nexport const changedAppointmentById: PureComputed<\n  [Changes, AppointmentId], AppointmentChanges\n> = (changes, appointmentId) => (\n  { [appointmentId]: changes }\n);\n","import moment from 'moment';\nimport { RRule, RRuleSet } from 'rrule';\nimport {\n  AppointmentModel, PreCommitChangesFn, Changes, MakeDateSequenceFn, EditFn, DeleteFn, ChangeFn,\n} from '../../types';\nimport { RECURRENCE_EDIT_SCOPE } from '../../constants';\nimport { getUTCDate, getRRuleSetWithExDates, formatDateToString } from '../../utils';\n\nconst mergeNewChanges = (\n  appointmentData: Partial<AppointmentModel>, changes: Changes,\n) => {\n  const appointment = {\n    ...appointmentData,\n  };\n  delete appointment.id;\n  delete appointment.rRule;\n  delete appointment.exDate;\n  delete appointment.parentData;\n  return { ...appointment, ...changes };\n};\n\nconst reduceExDate = (prevExDate: string, boundDate: Date) => {\n  if (prevExDate.length > 0) {\n    return prevExDate.split(',').reduce((acc: string[], date: string) => {\n      const momentDate = moment.utc(date);\n      if (momentDate.isBefore(boundDate)) {\n        return [...acc, date];\n      }\n      return acc;\n    }, []).join(',');\n  }\n  return undefined;\n};\n\nconst configureExDate = (exDate: string | undefined, date: Date) => {\n  const currentExDate = `${moment.utc(date).format('YYYYMMDDTHHmmss')}Z`;\n  return exDate\n    ? `${exDate},${currentExDate}`\n    : currentExDate;\n};\n\nconst configureDateSequence: MakeDateSequenceFn = (rRule, exDate, prevStartDate, nextStartDate) => {\n  const rruleSet = getRRuleSetWithExDates(exDate);\n\n  const currentOptions = RRule.parseString(rRule as string);\n  const correctedOptions = currentOptions.until\n    ? { ...currentOptions, until: moment(getUTCDate(currentOptions.until)).toDate() }\n    : currentOptions;\n  const prevStartDateUTC = moment(getUTCDate(prevStartDate!)).toDate();\n  rruleSet.rrule(new RRule({\n    ...correctedOptions,\n    dtstart: prevStartDateUTC,\n  }));\n  if (currentOptions.count || currentOptions.until) {\n    return rruleSet.all()\n      // we shouldn't use `new Date(string)` because this function has different results in Safari\n      .map(nextDate => moment(formatDateToString(nextDate)).toDate());\n  }\n  const leftBound = prevStartDateUTC;\n  const rightBound = moment(getUTCDate(nextStartDate!)).toDate();\n  return rruleSet.between(leftBound, rightBound, true)\n    .map(nextDate => moment(formatDateToString(nextDate)).toDate());\n};\n\nconst configureICalendarRules = (rRule: string | undefined, options: object) => {\n  const rruleSet = new RRuleSet();\n  rruleSet.rrule(new RRule({\n    ...RRule.parseString(rRule as string),\n    ...options,\n  }));\n  return rruleSet.valueOf();\n};\n\nconst changeCurrentAndFollowing: ChangeFn = (appointmentData, changes, changeAllAction) => {\n  const { rRule, startDate, parentData, exDate: prevExDate = '', id } = appointmentData;\n\n  const { initialSequence, currentChildIndex } = getAppointmentSequenceData(\n    parentData.startDate, moment.utc(startDate as Date).toDate(), prevExDate, rRule,\n  );\n\n  if (currentChildIndex === 0) return changeAllAction(appointmentData, changes);\n\n  const changedRules = configureICalendarRules(rRule as string, {\n    dtstart: moment.utc(parentData.startDate).toDate(),\n    until: moment.utc(initialSequence[currentChildIndex - 1]).toDate(),\n    count: null,\n  });\n\n  const nextExDate = reduceExDate(prevExDate, startDate as Date);\n  return {\n    changed: {\n      [id!]: {\n        rRule: changedRules[1].slice(6),\n        ...nextExDate && prevExDate !== nextExDate ? { exDate: nextExDate } : {},\n      },\n    },\n  };\n};\n\nconst getAppointmentSequenceData = (\n  prevStartDate: Date, startDate: Date, exDate: string, rRule: string | undefined,\n) => {\n  const initialSequence: Date[] = configureDateSequence(rRule, exDate,\n    moment.utc(prevStartDate).toDate(), moment.utc(startDate).toDate(),\n  );\n  const currentChildIndex = initialSequence\n    .findIndex(date => moment(date).isSame(startDate as Date));\n  return { initialSequence, currentChildIndex };\n};\n\nexport const deleteCurrent: DeleteFn = (appointmentData) => {\n  const currentSequence: Date[] = configureDateSequence(\n    appointmentData.rRule, appointmentData.exDate,\n    moment.utc(appointmentData.parentData.startDate).toDate(),\n    moment.utc(appointmentData.startDate).toDate(),\n  );\n\n  if (currentSequence.length === 1) {\n    return deleteAll(appointmentData);\n  }\n\n  const nextExDate = configureExDate(appointmentData.exDate, appointmentData.startDate as Date);\n  return { changed: { [appointmentData.id!]: { exDate: nextExDate } } };\n};\n\nexport const deleteAll: DeleteFn = (appointmentData) => {\n  return { deleted: appointmentData.id };\n};\n\nexport const deleteCurrentAndFollowing: DeleteFn = appointmentData => changeCurrentAndFollowing(\n  appointmentData, {}, deleteAll,\n);\n\nexport const editAll: EditFn = (appointmentData, changes) => {\n  const { rRule, id } = appointmentData;\n\n  const initialRule = new RRule(RRule.parseString(rRule as string));\n  if (changes.startDate\n    && moment.utc(changes.startDate as Date).isAfter(initialRule.options.until!)) {\n    return {\n      changed: {\n        [id!]: {\n          ...changes,\n          rRule: 'FREQ=DAILY;COUNT=1',\n          exDate: '',\n        },\n      },\n    };\n  }\n\n  return  { changed: {  [appointmentData.id!]: changes } };\n};\n\nexport const editCurrent: EditFn = (appointmentData, changes) => ({\n  changed: {\n    [appointmentData.id!]: {\n      exDate: configureExDate(appointmentData.exDate, appointmentData.startDate as Date),\n    },\n  },\n  added: mergeNewChanges(appointmentData as Partial<AppointmentModel>, changes as Changes),\n});\n\nexport const editCurrentAndFollowing: EditFn = (appointmentData, changes) => {\n  const { rRule, startDate, exDate: prevExDate = '', parentData } = appointmentData;\n  const initialRule = new RRule(RRule.parseString(rRule as string));\n\n  const { initialSequence, currentChildIndex } = getAppointmentSequenceData(\n    parentData.startDate, moment.utc(startDate as Date).toDate(),  prevExDate, rRule,\n  );\n  if (currentChildIndex === 0) return editAll(appointmentData, changes);\n\n  const addedOptions = initialRule.options.count || initialRule.options.until\n    ? { count: initialSequence.length - currentChildIndex }\n    : {};\n  const addedRules = configureICalendarRules(appointmentData.rRule as string, {\n    dtstart: moment.utc(startDate as Date).toDate(),\n    ...addedOptions,\n  });\n\n  const addedAppointment = moment.utc(changes.startDate as Date).isAfter(initialRule.options.until!)\n    ? { rRule: 'FREQ=DAILY;COUNT=1', exDate: '' } : { rRule: addedRules[1].slice(6) };\n\n  return {\n    changed: changeCurrentAndFollowing(appointmentData, changes, editAll).changed,\n    added: {\n      ...addedAppointment, ...mergeNewChanges(appointmentData, changes),\n    },\n  };\n};\n\nexport const preCommitChanges: PreCommitChangesFn = (\n  changes, appointmentData, editType,\n) => {\n  if (changes === null) {\n    switch (editType) {\n      case RECURRENCE_EDIT_SCOPE.ALL: {\n        return deleteAll(appointmentData);\n      }\n      case RECURRENCE_EDIT_SCOPE.CURRENT: {\n        return deleteCurrent(appointmentData);\n      }\n      case RECURRENCE_EDIT_SCOPE.CURRENT_AND_FOLLOWING: {\n        return deleteCurrentAndFollowing(appointmentData);\n      }\n    }\n  } else {\n    switch (editType) {\n      case RECURRENCE_EDIT_SCOPE.ALL: {\n        return editAll(appointmentData, changes);\n      }\n      case RECURRENCE_EDIT_SCOPE.CURRENT: {\n        return editCurrent(appointmentData, changes);\n      }\n      case RECURRENCE_EDIT_SCOPE.CURRENT_AND_FOLLOWING: {\n        return editCurrentAndFollowing(appointmentData, changes);\n      }\n    }\n  }\n  return {};\n};\n","import moment from 'moment';\nimport { PureComputed } from '@devexpress/dx-core';\nimport {\n  ViewCell, ClientOffset, TimeType, ScrollingStrategy,\n  AllDayCell, CalculateAppointmentTimeBoundaries,\n  TimeBoundariesByDrag, TimeBoundariesByResize, AppointmentModel,\n  CellElementsMeta, Grouping, ValidResource, Group, SchedulerDateTime, GroupOrientation,\n} from '../../types';\nimport {\n  VERTICAL_TYPE, HORIZONTAL_TYPE, SCROLL_OFFSET, MINUTES,\n  SECONDS, RESIZE_TOP, RESIZE_BOTTOM, HOURS,\n} from '../../constants';\nimport {\n  allDayRects, horizontalTimeTableRects, verticalTimeTableRects,\n} from '../common/calculate-rects';\n\nconst clamp: PureComputed<\n  [number, number, number]\n> = (value, min, max) => Math.max(Math.min(value, max), min);\n\nconst calculateInsideOffset: PureComputed<\n  [string, number, number], number\n> = (targetType, insidePart, cellDurationMinutes) => targetType === VERTICAL_TYPE\n  ? insidePart * cellDurationMinutes * 60 / 2 : 0;\n\nexport const cellType: PureComputed<\n  [ViewCell | AllDayCell], string\n> = data => moment(data.startDate as Date)\n  .isSame(data.endDate as Date, 'day') ? VERTICAL_TYPE : HORIZONTAL_TYPE;\n\nexport const intervalDuration: PureComputed<\n  [ViewCell | AllDayCell, TimeType], number\n> = (data, type) => moment(data.endDate as Date).diff(data.startDate as Date, type);\n\nexport const cellIndex: PureComputed<\n  [Array<() => ClientRect>, ClientOffset], number\n> = (getCellRects, clientOffset) => getCellRects.findIndex((getCellRect) => {\n  const { left, top, right, bottom } = getCellRect();\n  const isOver = clientOffset\n      && clamp(clientOffset.x, left, right) === clientOffset.x\n      && clamp(clientOffset.y, top, bottom) === clientOffset.y;\n  return isOver;\n});\n\nexport const cellData: PureComputed<\n  [number, number, ViewCell[][], ViewCell[][]], ViewCell | AllDayCell\n> = (timeTableIndex, allDayIndex, viewCellsData, allDayCellsData) => {\n  const cellsData = allDayIndex !== -1 ? allDayCellsData : viewCellsData;\n  const currentIndex = allDayIndex !== -1 ? allDayIndex : timeTableIndex;\n  const tableWidth = cellsData[0].length;\n\n  const rowIndex = Math.floor(currentIndex / tableWidth);\n  const columnIndex = currentIndex % tableWidth;\n  return cellsData[rowIndex][columnIndex];\n};\n\nexport const autoScroll: PureComputed<\n  [ClientOffset, ScrollingStrategy, number], void\n> = (clientOffset, scrollingStrategy, scrollSpeed) => {\n  scroll(\n    clientOffset.y, scrollingStrategy.topBoundary, scrollingStrategy.bottomBoundary,\n    scrollingStrategy.changeVerticalScroll, scrollSpeed,\n  );\n  scroll(\n    clientOffset.x, scrollingStrategy.leftBoundary, scrollingStrategy.rightBoundary,\n    scrollingStrategy.changeHorizontalScroll, scrollSpeed,\n  );\n};\n\nconst scroll: PureComputed<\n  [number, number, number, (value: number) => void, number], void\n> = (offset, firstBoundary, secondBoundary, changeScroll, scrollSpeed) => {\n  if ((offset < firstBoundary + SCROLL_OFFSET) && (offset > firstBoundary)) {\n    changeScroll(-scrollSpeed);\n  }\n  if (secondBoundary - SCROLL_OFFSET < offset) {\n    changeScroll(+scrollSpeed);\n  }\n};\n\nexport const timeBoundariesByResize: TimeBoundariesByResize = (\n  payload, targetData, targetType, cellDurationMinutes, insidePart,\n) => {\n  if (targetType !== payload.appointmentType) {\n    return { appointmentStartTime: undefined, appointmentEndTime: undefined };\n  }\n\n  let appointmentStartTime;\n  let appointmentEndTime;\n  const sourceType = payload.type;\n\n  if (sourceType === RESIZE_TOP) {\n    const insideTopOffset = calculateInsideOffset(targetType, insidePart, cellDurationMinutes);\n    appointmentStartTime = moment(targetData.startDate as Date)\n      .add(insideTopOffset, SECONDS).toDate();\n    appointmentEndTime = moment(payload.endDate as Date).toDate();\n  }\n  if (sourceType === RESIZE_BOTTOM) {\n    const insideBottomOffset = insidePart === 0 && targetType === VERTICAL_TYPE\n      ? cellDurationMinutes * 60 / 2 : 0;\n    appointmentEndTime = moment(targetData.endDate as Date)\n      .add(-insideBottomOffset, SECONDS).toDate();\n    appointmentStartTime = moment(payload.startDate as Date).toDate();\n  }\n  // keep origin appointment duration if coordinates are wrong\n  if (moment(appointmentEndTime).diff(appointmentStartTime, MINUTES) < 1) {\n    appointmentStartTime = moment(payload.startDate as Date).toDate();\n    appointmentEndTime = moment(payload.endDate as Date).toDate();\n  }\n  return { appointmentStartTime, appointmentEndTime };\n};\n\nexport const timeBoundariesByDrag: TimeBoundariesByDrag = (\n  payload, targetData, targetType,\n  cellDurationMinutes, insidePart, offsetTimeTopBase,\n) => {\n  if (targetType === HORIZONTAL_TYPE\n    && intervalDuration(payload, SECONDS) < intervalDuration(targetData, SECONDS)) {\n    return {\n      appointmentStartTime: targetData.startDate as Date,\n      appointmentEndTime: targetData.endDate as Date,\n      offsetTimeTop: 0,\n    };\n  }\n  let offsetTimeTop;\n  let appointmentStartTime;\n  let appointmentEndTime;\n\n  const insideOffset = calculateInsideOffset(targetType, insidePart, cellDurationMinutes);\n  const start = moment(targetData.startDate as Date).add(insideOffset, SECONDS);\n\n  if (offsetTimeTopBase === null) {\n    offsetTimeTop = moment(targetData.startDate as Date)\n      .diff(payload.startDate as Date, SECONDS) + insideOffset;\n  } else {\n    offsetTimeTop = offsetTimeTopBase;\n  }\n\n  if (payload.type === targetType) {\n    const appointmentDurationSeconds = intervalDuration(payload, SECONDS);\n    appointmentStartTime = moment(start).add((offsetTimeTop) * (-1), SECONDS).toDate();\n    appointmentEndTime = moment(start)\n      .add((appointmentDurationSeconds - offsetTimeTop), SECONDS).toDate();\n  } else {\n    appointmentStartTime = moment(targetData.startDate as Date)\n      .add(insideOffset, SECONDS).toDate();\n    appointmentEndTime = moment(targetData.endDate as Date).add(insideOffset, SECONDS).toDate();\n  }\n\n  return { appointmentStartTime, appointmentEndTime, offsetTimeTop };\n};\n\nexport const calculateAppointmentTimeBoundaries: CalculateAppointmentTimeBoundaries = (\n  payload, targetData, targetType,\n  cellDurationMinutes, insidePart, offsetTimeTopBase,\n) => {\n  const isDragging = (payload.type === VERTICAL_TYPE || payload.type === HORIZONTAL_TYPE);\n\n  return(isDragging\n    ? timeBoundariesByDrag(\n        payload, targetData as AppointmentModel, targetType,\n        cellDurationMinutes, insidePart, offsetTimeTopBase,\n      )\n    : timeBoundariesByResize(\n        payload, targetData as AppointmentModel, targetType, cellDurationMinutes, insidePart,\n      )\n  );\n};\n\nexport const calculateInsidePart: PureComputed<\n  [number, Array<() => ClientRect>, number]\n> = (top, timeTableCellsRects, timeTableIndex) => {\n  if (timeTableIndex !== undefined && timeTableIndex !== -1) {\n    const cellRect = timeTableCellsRects[timeTableIndex]();\n    return top > cellRect.top + cellRect.height / 2 ? 1 : 0;\n  }\n  return 0;\n};\n\nexport const calculateDraftAppointments = (\n  allDayIndex: number, draftAppointments: any, startViewDate: Date,\n  endViewDate: Date, excludedDays: number[], viewCellsData: any,\n  getAllDayCellsElementRects: CellElementsMeta,\n  targetType: string, cellDurationMinutes: number,\n  getTableCellElementRects: CellElementsMeta,\n  grouping: Grouping[], resources: ValidResource[], groups: Group[][],\n  groupOrientation: GroupOrientation, groupedByDate: boolean,\n) => {\n  if (allDayIndex !== -1 || (targetType === VERTICAL_TYPE\n    && getAllDayCellsElementRects.getCellRects.length\n    && intervalDuration(draftAppointments[0].dataItem, HOURS) > 23)) {\n    const allDayDrafts = draftAppointments.map((draftAppt: any) => ({\n      ...draftAppt,\n      allDay: true,\n    }));\n\n    return {\n      allDayDraftAppointments: allDayRects(\n        allDayDrafts, startViewDate, endViewDate,\n        excludedDays, viewCellsData, getAllDayCellsElementRects,\n        grouping, resources, groups, groupOrientation, groupedByDate,\n      ),\n      timeTableDraftAppointments: [],\n    };\n  }\n\n  if (targetType === VERTICAL_TYPE || allDayIndex !== -1) {\n    return {\n      allDayDraftAppointments: [],\n      timeTableDraftAppointments: verticalTimeTableRects(\n        draftAppointments, startViewDate, endViewDate,\n        excludedDays, viewCellsData, cellDurationMinutes, getTableCellElementRects,\n        grouping, resources, groups, groupOrientation, groupedByDate,\n      ),\n    };\n  }\n  return {\n    allDayDraftAppointments: [],\n    timeTableDraftAppointments: horizontalTimeTableRects(\n      draftAppointments, startViewDate, endViewDate,\n      viewCellsData, getTableCellElementRects,\n      grouping, resources, groups, groupOrientation, groupedByDate,\n    ),\n  };\n};\n\nexport const calculateAppointmentGroups: PureComputed<\n  [Array<Group> | undefined, Array<ValidResource>, AppointmentModel], any\n> = (cellGroupingInfo, resources, appointmentData) => {\n  if (!cellGroupingInfo) return {};\n  return cellGroupingInfo.reduce((acc, group: Group) => {\n    const isMultipleResource = resources.find(\n      resource => (resource.fieldName === group.fieldName),\n    )!.allowMultiple;\n    return {\n      ...acc,\n      [group.fieldName]: isMultipleResource\n        ? updateMultipleResourceInfo(group, appointmentData) : group.id,\n    };\n  }, {});\n};\n\nconst updateMultipleResourceInfo: PureComputed<\n  [Group, AppointmentModel], any\n> = (cellResource, appointmentData) => {\n  const appointmentGroupItems = appointmentData[cellResource.fieldName];\n  if (appointmentGroupItems.findIndex((groupItem: any) => groupItem === cellResource.id) !== -1) {\n    return appointmentGroupItems;\n  }\n  return [cellResource.id];\n};\n\nexport const appointmentDragged: PureComputed<\n  [SchedulerDateTime, SchedulerDateTime, SchedulerDateTime, SchedulerDateTime, any, any], boolean\n> = (start, startPrev, end, endPrev, groupingInfo, groupingInfoPrev) => {\n  if (moment(start as Date).isSame(startPrev as Date)\n      && moment(end as Date).isSame(endPrev as Date)\n      && groupingInfoNotChanged(groupingInfo, groupingInfoPrev)) {\n    return false;\n  }\n  return true;\n};\n\nconst groupingInfoNotChanged: PureComputed<\n  [any, any], boolean\n> = (groupingInfo, groupingInfoPrev) => {\n  const fields = Object.getOwnPropertyNames(groupingInfo);\n  return fields.every((field) => {\n    if (Array.isArray(groupingInfo[field]) && Array.isArray(groupingInfoPrev[field])) {\n      return groupingInfo[field].every((item: any, index: number) => (\n        item === groupingInfoPrev[field][index]\n      ));\n    }\n    return groupingInfo[field] === groupingInfoPrev[field];\n  });\n};\n","import { PureComputed } from '@devexpress/dx-core';\nimport moment from 'moment';\nimport {\n  IsCellShadedFn, IsShadedAppointment,\n  GetCurrentTimeIndicatorTopFn,\n} from '../../types';\n\nexport const isMonthCell: PureComputed<\n  [boolean | undefined], boolean\n> = otherMonth => otherMonth !== undefined;\n\nexport const isShadedAppointment: IsShadedAppointment = (\n  { data: appointmentData }, currentTime, shadePreviousAppointments,\n) => {\n  const momentCurrentDate = moment(currentTime);\n  if (appointmentData.allDay) {\n    return momentCurrentDate.isAfter(appointmentData.endDate as Date, 'day')\n    && shadePreviousAppointments;\n  }\n  if (momentCurrentDate.isAfter(appointmentData.endDate as Date)) {\n    return shadePreviousAppointments;\n  }\n  return false;\n};\n\nexport const getCurrentTimeIndicatorTop: GetCurrentTimeIndicatorTopFn = (\n  cellData, currentTime,\n) => {\n  const top = ((currentTime - cellData.startDate.getTime()) * 100)\n  / (cellData.endDate.getTime() - cellData.startDate.getTime());\n  return (top < 0 || top > 100) ? undefined : `${top}%`;\n};\n\nexport const isCellShaded: IsCellShadedFn = (\n  { startDate, endDate, otherMonth }, currentTime, shadePreviousCells,\n) => {\n  const monthCell = isMonthCell(otherMonth);\n  return ((startDate.getTime() < currentTime && !monthCell)\n    || endDate.getTime() < currentTime && monthCell) && shadePreviousCells;\n};\n","import { GetAppointmentResources, ValidResourceInstance, ValidResource } from '../../types';\nimport { PureComputed } from '@devexpress/dx-core';\n\nexport const getAppointmentResources: GetAppointmentResources = (\n  appointment, resources, plainResources,\n) => {\n  if (\n    !resources || resources.length === 0\n    || !plainResources || plainResources.length === 0\n  ) return [];\n\n  return resources.reduce((acc, resource) => {\n    const appointmentResourceId = appointment[resource.fieldName];\n    if (appointmentResourceId === undefined) return acc;\n\n    if (resource.allowMultiple && !Array.isArray(appointmentResourceId)\n    || !resource.allowMultiple && Array.isArray(appointmentResourceId)) {\n      // throw error\n      return acc;\n    }\n\n    if (resource.allowMultiple) {\n      return [\n        ...acc,\n        ...(appointmentResourceId as Array<number | string>)\n        .reduce((prevResources, itemId) => addResourceToAppointmentResources(\n          plainResources, prevResources, resource, itemId,\n        ) as Array<ValidResourceInstance>, [] as Array<ValidResourceInstance>),\n      ];\n    }\n\n    return addResourceToAppointmentResources(\n      plainResources, acc, resource, appointmentResourceId,\n    ) as Array<ValidResourceInstance>;\n  }, [] as Array<ValidResourceInstance>);\n};\n\nconst addResourceToAppointmentResources: PureComputed<\n  [Array<ValidResourceInstance>, Array<ValidResourceInstance>, ValidResource,\n  number | string], Array<ValidResourceInstance>\n> = (plainResources, appointmentResources, resource, resourceId) => {\n  const currentResource = plainResources.find(\n    plainItem => resource.fieldName === plainItem.fieldName && plainItem.id === resourceId,\n  );\n\n  return currentResource ? [\n    ...appointmentResources,\n    currentResource!,\n  ] : appointmentResources;\n};\n","import {\n  ConvertResourcesToPlain, ValidateResources, ValidResourceInstance, AddResourcesToAppointments,\n} from '../../types';\nimport { getAppointmentResources } from './helpers';\n\nexport const convertResourcesToPlain: ConvertResourcesToPlain = (validResources) => {\n  return validResources.reduce((acc, resource) => [\n    ...acc,\n    ...resource.instances.map(item => item),\n  ], [] as Array<ValidResourceInstance>);\n};\n\nexport const validateResources: ValidateResources = (resources, mainResourceName, palette) => {\n  const isMainResourceDefined = !!mainResourceName;\n  let currentPaletteIndex = 0;\n  return resources.map((resource, groupIndex) => {\n    const fieldName = resource.fieldName;\n    const isMain = isMainResourceDefined && mainResourceName === fieldName\n      || groupIndex === 0 && !isMainResourceDefined;\n    const title = resource.title || fieldName;\n    const allowMultiple = !!resource.allowMultiple;\n    return {\n      fieldName,\n      isMain,\n      title,\n      allowMultiple,\n      instances: resource.instances.map((resourceItem) => {\n        const color = resourceItem.color || palette[currentPaletteIndex % palette.length];\n        if (!resourceItem.color) currentPaletteIndex += 1;\n\n        return ({\n          id: resourceItem.id,\n          color,\n          fieldName,\n          text: resourceItem.text || title || fieldName,\n          title,\n          allowMultiple,\n          isMain,\n        });\n      }),\n    };\n  });\n};\n\nexport const addResourcesToAppointments: AddResourcesToAppointments = (\n  appointments, resources, plainResources,\n) => [\n  appointments.map(appointment => ({\n    ...appointment,\n    resources: getAppointmentResources(appointment.dataItem, resources, plainResources),\n  })),\n];\n","import { PureReducer, slice } from '@devexpress/dx-core';\nimport {\n  ResourceGroupingState, ToggleGroupPayload,\n} from '../../types';\n\nexport const toggleExpandedGroups: PureReducer<ResourceGroupingState, ToggleGroupPayload> = (\n  state, { groupKey },\n) => {\n  const expandedGroups = slice(state.expandedGroups);\n  const groupKeyIndex = expandedGroups.indexOf(groupKey);\n\n  if (groupKeyIndex > -1) {\n    expandedGroups.splice(groupKeyIndex, 1);\n  } else {\n    expandedGroups.push(groupKey);\n  }\n\n  return { expandedGroups };\n};\n","import moment, { Moment } from 'moment';\nimport { ViewCell } from '../../types';\nimport { PureComputed } from '@devexpress/dx-core';\n\nexport const getDayScaleCellColSpan: PureComputed<\n  [ViewCell[][]], number\n> = (cellsData) => {\n  const firstDate = cellsData[0][0].startDate;\n  let count = 1;\n  while (cellsData[0][count] && moment(cellsData[0][count].startDate).isSame(firstDate, 'day')) {\n    count += 1;\n  }\n  return count;\n};\n\nexport const getDayScaleCells: PureComputed<\n[ViewCell[][], boolean], ViewCell[]\n> = (cellsData, groupedByDate) => {\n  if (!groupedByDate) {\n    return cellsData[0].map(({\n      startDate, endDate, today, endOfGroup, groupingInfo,\n    }, index) => ({\n      key: index.toString(),\n      startDate, endDate, today, endOfGroup, groupingInfo,\n    }));\n  }\n  let prevDate: Moment;\n  const colSpan = getDayScaleCellColSpan(cellsData);\n  return cellsData[0].reduce((acc, { startDate, endDate, today }, index) => {\n    const currentDate = moment(startDate);\n    if (currentDate.isSame(prevDate)) {\n      return acc;\n    }\n    prevDate = currentDate;\n    return [\n      ...acc, {\n        key: index.toString(),\n        startDate, endDate, today, colSpan,\n        endOfGroup: true,\n      },\n    ];\n  }, [] as ViewCell[]);\n};\n","import { PureComputed } from '@devexpress/dx-core';\nimport { SchedulerDateTime } from '../../types';\nimport moment from 'moment';\n\nexport const navigateByOneMonth: PureComputed<\n  [SchedulerDateTime, boolean], Date\n> = (currentDate, isBackward) => moment(currentDate as SchedulerDateTime)\n  [isBackward ? 'subtract' : 'add'](1, 'month').toDate();\n","import { AppointmentModel, SchedulerDateTime } from './scheduler-core.types';\nimport { PureComputed } from '@devexpress/dx-core';\nimport { RRULE_REPEAT_TYPES } from '../plugins/appointment-form/constants';\n\n/** @internal */\nexport type Action = ([fieldName]?: any) => void;\n/** @internal */\nexport type StartDate = SchedulerDateTime;\n/** @internal */\nexport type EndDate = SchedulerDateTime;\n/** @internal */\nexport type AppointmentDataPayload = {\n  appointmentData: AppointmentModel;\n};\n/** @internal */\nexport type AddedAppointmentDataPayload = {\n  appointmentData: AppointmentModel | {};\n};\n/** @internal */\nexport type RadioGroupDisplayData = {\n  weekNumber: number;\n  dayNumberTextField: number;\n  dayOfWeek: number;\n  radioGroupValue: string;\n};\n/** An option in the Select editor. */\nexport type SelectOption = {\n  /** The option's text. */\n  text: string;\n  /** The option's id. */\n  id: number | string;\n};\n/** @internal */\nexport type OptionsFormatterFn = PureComputed<\n  [(messageKey: string) => string], Array<SelectOption>\n>;\n/** @internal */\nexport type DateFormatterFn = PureComputed<\n  [(date: Date, formatOptions: object) => string], Array<SelectOption>\n>;\n/** @internal */\nexport enum RecurrenceFrequency {\n  Daily = RRULE_REPEAT_TYPES.DAILY,\n  Weekly = RRULE_REPEAT_TYPES.WEEKLY,\n  Monthly = RRULE_REPEAT_TYPES.MONTHLY,\n  Yearly = RRULE_REPEAT_TYPES.YEARLY,\n}\n"],"names":["RRule","RRuleSet","isMidnight","getCellRect","slice","RecurrenceFrequency"],"mappings":"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"}